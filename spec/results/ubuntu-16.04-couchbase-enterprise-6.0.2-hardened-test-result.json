{"platform":{"name":"ubuntu","release":"16.04"},"profiles":[{"name":"Database_Generic_SRG","version":"0.1.0","sha256":"3fcc734d3be665be50a841a23eb5c9ead7915c9f1c7a81249a2dbd0adbf92bf1","title":"Database Security Requirements Guide","maintainer":"The Authors","summary":"The Database Security Requirements Guide (SRG) is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the NIST 800-53 and related documents. Comments or proposed revisions to this document should be sent via e-mail to the following address: disa.stig_spt@mail.mil.","license":"Apache-2.0","copyright":"The Authors","copyright_email":"you@example.com","supports":[],"attributes":[{"name":"cb_service_user","options":{"value":"couchbase"}},{"name":"cb_service_group","options":{"value":"couchbase"}},{"name":"cb_full_admin","options":{"value":"admin"}},{"name":"cb_full_admin_password","options":{"value":"password"}},{"name":"cb_admin_users","options":{"value":["cbadmin"]}},{"name":"cb_users","options":{"value":["cbuser"]}},{"name":"cb_roles","options":{"value":["admin","bucket_admin"]}},{"name":"cb_use_saslauthd","options":{"value":"true"}},{"name":"cb_use_ldap","options":{"value":"false"}},{"name":"cb_use_pki","options":{"value":"true"}},{"name":"cb_auth_domain","options":{"value":"local"}},{"name":"cb_private_key_path","options":{"value":"/etc/ssl/ca.key"}},{"name":"cb_ca_file_path","options":{"value":"/etc/ssl/ca.pem"}},{"name":"cb_home_dir","options":{"value":"/opt/couchbase"}},{"name":"cb_data_dir","options":{"value":"/opt/couchbase/var/lib/couchbase/data"}},{"name":"cb_config_dir","options":{"value":"opt/couchbase/etc/couchbase"}},{"name":"cb_log_dir","options":{"value":"/opt/couchbase/var/lib/couchbase/logs"}},{"name":"cb_samples_dir","options":{"value":"/opt/couchbase/samples"}},{"name":"cb_audit_log","options":{"value":"/opt/couchbase/var/lib/couchbase/logs/audit.log"}},{"name":"cb_static_config","options":{"value":"/opt/couchbase/etc/couchbase/static_config"}},{"name":"cb_http_access_log","options":{"value":"/opt/couchbase/var/lib/couchbase/logs/http_access.log"}},{"name":"cb_http_access_internal_log","options":{"value":"/opt/couchbase/var/lib/couchbase/logs/ http_access_internal.log"}},{"name":"sample_buckets","options":{"value":["travel-sample","gamesim-sample","beer-sample"]}},{"name":"cb_required_audit_events","options":{"value":["Service configuration change","authentication succeeded","session terminated"]}},{"name":"cb_required_audit_event_ids","options":{"value":["36865","20485","20493","20489"]}},{"name":"cb_cluster_host","options":{"value":"localhost"}},{"name":"cb_cluster_port","options":{"value":"8091"}},{"name":"cb_latest_version","options":{"value":"6.6"}},{"name":"cb_redhat_approved_packages","options":{"value":["couchbase-release.x86_64","couchbase-server.x86_64"]}},{"name":"cb_debian_approved_packages","options":{"value":["couchbase-server"]}},{"name":"approved_ssl_protocol","options":{"value":"tlsv1.2"}},{"name":"approved_ciphers","options":{"value":["TLS_RSA_WITH_AES_128_CBC_SHA","TLS_RSA_WITH_AES_256_CBC_SHA"]}}],"groups":[{"id":"controls/V-58179.rb","controls":["V-58179"]},{"id":"controls/V-58171.rb","controls":["V-58171"]},{"id":"controls/V-58151.rb","controls":["V-58151"]},{"id":"controls/V-58161.rb","controls":["V-58161"]},{"id":"controls/V-58177.rb","controls":["V-58177"]},{"id":"controls/V-58159.rb","controls":["V-58159"]},{"id":"controls/V-58167.rb","controls":["V-58167"]}],"controls":[{"id":"V-58179","title":"Couchbase and associated applications must reserve the use of dynamic\n  code execution for situations that require it.","desc":"With respect to database management systems, one class of threat is\n  known as SQL Injection, or more generally, code injection. It takes advantage\n  of the dynamic execution capabilities of various programming languages,\n  including dialects of SQL. In such cases, the attacker deduces the manner in\n  which SQL statements are being processed, either from inside knowledge or by\n  observing system behavior in response to invalid inputs. When the attacker\n  identifies scenarios where SQL queries are being assembled by application code\n  (which may be within the database or separate from it) and executed\n  dynamically, the attacker is then able to craft input strings that subvert the\n  intent of the query. Potentially, the attacker can gain unauthorized access to\n  data, including security settings, and severely corrupt or destroy the database.\n\n  The principal protection against code injection is not to use dynamic\n  execution except where it provides necessary functionality that cannot be\n  utilized otherwise. Use strongly typed data items rather than general-purpose\n  strings as input parameters to task-specific, pre-compiled stored procedures\n  and functions (and triggers).\n\n  This calls for inspection of application source code, which will require\n  collaboration with the application developers. It is recognized that in many\n  cases, the database administrator (DBA) is organizationally separate from the\n  application developers, and may have limited, if any, access to source code.\n  Nevertheless, protections of this type are so important to the secure operation\n  of databases that they must not be ignored. At a minimum, the DBA must attempt\n  to obtain assurances from the development organization that this issue has been\n  addressed, and must document what has been discovered.","descriptions":[{"label":"default","data":"With respect to database management systems, one class of threat is\n  known as SQL Injection, or more generally, code injection. It takes advantage\n  of the dynamic execution capabilities of various programming languages,\n  including dialects of SQL. In such cases, the attacker deduces the manner in\n  which SQL statements are being processed, either from inside knowledge or by\n  observing system behavior in response to invalid inputs. When the attacker\n  identifies scenarios where SQL queries are being assembled by application code\n  (which may be within the database or separate from it) and executed\n  dynamically, the attacker is then able to craft input strings that subvert the\n  intent of the query. Potentially, the attacker can gain unauthorized access to\n  data, including security settings, and severely corrupt or destroy the database.\n\n  The principal protection against code injection is not to use dynamic\n  execution except where it provides necessary functionality that cannot be\n  utilized otherwise. Use strongly typed data items rather than general-purpose\n  strings as input parameters to task-specific, pre-compiled stored procedures\n  and functions (and triggers).\n\n  This calls for inspection of application source code, which will require\n  collaboration with the application developers. It is recognized that in many\n  cases, the database administrator (DBA) is organizationally separate from the\n  application developers, and may have limited, if any, access to source code.\n  Nevertheless, protections of this type are so important to the secure operation\n  of databases that they must not be ignored. At a minimum, the DBA must attempt\n  to obtain assurances from the development organization that this issue has been\n  addressed, and must document what has been discovered."},{"label":"check","data":"Review Couchbase source code (stored procedures, functions, triggers) and\napplication source code, to identify cases of dynamic code execution.\n\nIf dynamic code execution is employed in circumstances where the objective\ncould practically be satisfied by static execution with strongly typed\nparameters, this is a finding."},{"label":"fix","data":"Where dynamic code execution is employed in circumstances where\nthe objective could practically be satisfied by static execution with strongly\ntyped parameters, modify the code to do so."}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000251-DB-000391","gid":"V-58179","rid":"SV-72609r2_rule","stig_id":"SRG-APP-000251-DB-000391","fix_id":"F-63387r1_fix","cci":["CCI-001310"],"nist":["SI-10","Rev_4"]},"code":"control \"V-58179\" do\n  title \"Couchbase and associated applications must reserve the use of dynamic\n  code execution for situations that require it.\"\n  desc  \"With respect to database management systems, one class of threat is\n  known as SQL Injection, or more generally, code injection. It takes advantage\n  of the dynamic execution capabilities of various programming languages,\n  including dialects of SQL. In such cases, the attacker deduces the manner in\n  which SQL statements are being processed, either from inside knowledge or by\n  observing system behavior in response to invalid inputs. When the attacker\n  identifies scenarios where SQL queries are being assembled by application code\n  (which may be within the database or separate from it) and executed\n  dynamically, the attacker is then able to craft input strings that subvert the\n  intent of the query. Potentially, the attacker can gain unauthorized access to\n  data, including security settings, and severely corrupt or destroy the database.\n\n  The principal protection against code injection is not to use dynamic\n  execution except where it provides necessary functionality that cannot be\n  utilized otherwise. Use strongly typed data items rather than general-purpose\n  strings as input parameters to task-specific, pre-compiled stored procedures\n  and functions (and triggers).\n\n  This calls for inspection of application source code, which will require\n  collaboration with the application developers. It is recognized that in many\n  cases, the database administrator (DBA) is organizationally separate from the\n  application developers, and may have limited, if any, access to source code.\n  Nevertheless, protections of this type are so important to the secure operation\n  of databases that they must not be ignored. At a minimum, the DBA must attempt\n  to obtain assurances from the development organization that this issue has been\n  addressed, and must document what has been discovered.\n  \"\n  desc  \"check\", \"\n  Review Couchbase source code (stored procedures, functions, triggers) and\n  application source code, to identify cases of dynamic code execution.\n  \n  If dynamic code execution is employed in circumstances where the objective\n  could practically be satisfied by static execution with strongly typed\n  parameters, this is a finding.\n  \"\n  desc  \"fix\", \"\n  Where dynamic code execution is employed in circumstances where\n  the objective could practically be satisfied by static execution with strongly\n  typed parameters, modify the code to do so.\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000251-DB-000391\"\n  tag \"gid\": \"V-58179\"\n  tag \"rid\": \"SV-72609r2_rule\"\n  tag \"stig_id\": \"SRG-APP-000251-DB-000391\"\n  tag \"fix_id\": \"F-63387r1_fix\"\n  tag \"cci\": [\"CCI-001310\"]\n  tag \"nist\": [\"SI-10\", \"Rev_4\"]\n  \n  describe \"This test requires a Manual Review: Review Couchbase source code \n  (stored procedures, functions, triggers) and application source code, to identify \n  cases of dynamic code execution.\" do\n    skip \"This test requires a Manual Review: Review Couchbase source code \n    (stored procedures, functions, triggers) and application source code, to identify \n    cases of dynamic code execution.\"\n  end \n\n  describe \"This test requires a Manual Review: If dynamic code execution is employed in \n  circumstances where the objective could practically be satisfied by static execution with\n  strongly typed parameters, this is a finding.\" do\n    skip \"This test requires a Manual Review: If dynamic code execution is employed in \n    circumstances where the objective could practically be satisfied by static execution with\n    strongly typed parameters, this is a finding.\"\n  end  \nend\n","source_location":{"line":3,"ref":"/home/ubuntu/Desktop/couchbase-enterprise-srg-baseline/controls/V-58179.rb"},"waiver_data":{},"results":[{"status":"skipped","code_desc":"This test requires a Manual Review: Review Couchbase source code \n  (stored procedures, functions, triggers) and application source code, to identify \n  cases of dynamic code execution.","run_time":1.794e-05,"start_time":"2020-09-22T13:06:31-04:00","resource":"","skip_message":"This test requires a Manual Review: Review Couchbase source code \n    (stored procedures, functions, triggers) and application source code, to identify \n    cases of dynamic code execution."},{"status":"skipped","code_desc":"This test requires a Manual Review: If dynamic code execution is employed in \n  circumstances where the objective could practically be satisfied by static execution with\n  strongly typed parameters, this is a finding.","run_time":4.12e-06,"start_time":"2020-09-22T13:06:31-04:00","resource":"","skip_message":"This test requires a Manual Review: If dynamic code execution is employed in \n    circumstances where the objective could practically be satisfied by static execution with\n    strongly typed parameters, this is a finding."}]},{"id":"V-58171","title":"Couchbase must implement cryptographic mechanisms preventing the\n  unauthorized disclosure of organization-defined information at rest on\n  organization-defined information system components.","desc":"Couchbases handling data requiring \"data at rest\" protections must\n  employ cryptographic mechanisms to prevent unauthorized disclosure and\n  modification of the information at rest. These cryptographic mechanisms may be\n  native to Couchbase or implemented via additional software or operating\n  system/file system settings, as appropriate to the situation.\n\n  Selection of a cryptographic mechanism is based on the need to protect the\n  integrity of organizational information. The strength of the mechanism is\n  commensurate with the security category and/or classification of the\n  information. Organizations have the flexibility to either encrypt all\n  information on storage devices (i.e., full disk encryption) or encrypt specific\n  data structures (e.g., files, records, or fields).\n\n  The decision whether and what to encrypt rests with the data owner and is\n  also influenced by the physical measures taken to secure the equipment and\n  media on which the information resides.","descriptions":[{"label":"default","data":"Couchbases handling data requiring \"data at rest\" protections must\n  employ cryptographic mechanisms to prevent unauthorized disclosure and\n  modification of the information at rest. These cryptographic mechanisms may be\n  native to Couchbase or implemented via additional software or operating\n  system/file system settings, as appropriate to the situation.\n\n  Selection of a cryptographic mechanism is based on the need to protect the\n  integrity of organizational information. The strength of the mechanism is\n  commensurate with the security category and/or classification of the\n  information. Organizations have the flexibility to either encrypt all\n  information on storage devices (i.e., full disk encryption) or encrypt specific\n  data structures (e.g., files, records, or fields).\n\n  The decision whether and what to encrypt rests with the data owner and is\n  also influenced by the physical measures taken to secure the equipment and\n  media on which the information resides."},{"label":"check","data":"Review the system documentation to determine whether the organization has\ndefined the information to prevent the unauthorized disclosure of\norganization-defined information at rest on organization-defined information\nsystem components.\n\nIf the documentation indicates no information requires such protections,\nthis is not a finding.\n\nIf any of the information defined as requiring protection is not encrypted\nin a manner that provides the required level of protection and is not\nphysically secured to the required level, this is a finding.\n\nAs the Full Admin, verify that SSL encryption is enabled:\n$ couchbase-cli ssl-manage -c <host>:<port> -u <Full Admin> -p <Password> \n--client-auth --extended\n\nReview the output. If \"state\" is not set to \"enabled\" or \"mandatory\", \nthis is a finding.\n\nIf an encryption at rest is required but the encryption tool is not\ninstalled on the server, this is a finding."},{"label":"fix","data":"Configure Couchbase to provide the required level of cryptographic\nprotection for information requiring cryptographic protection against\ndisclosure.\n\nSecure the premises, equipment, and media to provide the required level of\nphysical protection.\n\nReview  documentation to set up 3rd party encryption tools.\nhttps://docs.couchbase.com/server/current/manage/manage-security/manage-connections-and-disks.html\n\nFor information on configuring Couchbase to use SSL, see the following\ndocumentation https://docs.couchbase.com/server/current/manage/manage-security/manage-certificates.html"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000429-DB-000387","gid":"V-58171","rid":"SV-72601r1_rule","stig_id":"SRG-APP-000429-DB-000387","fix_id":"F-63379r1_fix","cci":["CCI-002476"],"nist":["SC-28 (1)","Rev_4"]},"code":"control \"V-58171\" do\n  title \"Couchbase must implement cryptographic mechanisms preventing the\n  unauthorized disclosure of organization-defined information at rest on\n  organization-defined information system components.\"\n  desc  \"Couchbases handling data requiring \\\"data at rest\\\" protections must\n  employ cryptographic mechanisms to prevent unauthorized disclosure and\n  modification of the information at rest. These cryptographic mechanisms may be\n  native to Couchbase or implemented via additional software or operating\n  system/file system settings, as appropriate to the situation.\n\n  Selection of a cryptographic mechanism is based on the need to protect the\n  integrity of organizational information. The strength of the mechanism is\n  commensurate with the security category and/or classification of the\n  information. Organizations have the flexibility to either encrypt all\n  information on storage devices (i.e., full disk encryption) or encrypt specific\n  data structures (e.g., files, records, or fields).\n\n  The decision whether and what to encrypt rests with the data owner and is\n  also influenced by the physical measures taken to secure the equipment and\n  media on which the information resides.\n  \"\n  desc  \"check\", \"\n  Review the system documentation to determine whether the organization has\n  defined the information to prevent the unauthorized disclosure of\n  organization-defined information at rest on organization-defined information\n  system components.\n  \n  If the documentation indicates no information requires such protections,\n  this is not a finding.\n  \n  If any of the information defined as requiring protection is not encrypted\n  in a manner that provides the required level of protection and is not\n  physically secured to the required level, this is a finding.\n  \n  As the Full Admin, verify that SSL encryption is enabled:\n  $ couchbase-cli ssl-manage -c <host>:<port> -u <Full Admin> -p <Password> \n  --client-auth --extended\n\n  Review the output. If \\\"state\\\" is not set to \\\"enabled\\\" or \\\"mandatory\\\", \n  this is a finding.\n\n  If an encryption at rest is required but the encryption tool is not\n  installed on the server, this is a finding.\n  \"\n  desc  \"fix\", \"\n  Configure Couchbase to provide the required level of cryptographic\n  protection for information requiring cryptographic protection against\n  disclosure.\n  \n  Secure the premises, equipment, and media to provide the required level of\n  physical protection.\n  \n  Review  documentation to set up 3rd party encryption tools.\n  https://docs.couchbase.com/server/current/manage/manage-security/manage-connections-and-disks.html\n\n  For information on configuring Couchbase to use SSL, see the following\n  documentation https://docs.couchbase.com/server/current/manage/manage-security/manage-certificates.html\n \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000429-DB-000387\"\n  tag \"gid\": \"V-58171\"\n  tag \"rid\": \"SV-72601r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000429-DB-000387\"\n  tag \"fix_id\": \"F-63379r1_fix\"\n  tag \"cci\": [\"CCI-002476\"]\n  tag \"nist\": [\"SC-28 (1)\", \"Rev_4\"]\n  \n  describe \"Couchbase should have SSL enabled\" do\n    subject { json( command: \"couchbase-cli ssl-manage -c #{input('cb_cluster_host')}:#{input('cb_cluster_port')} \\\n    -u #{input('cb_full_admin')} -p #{input('cb_full_admin_password')} --client-auth --extended\") }\n    its('state') { should eq 'enable' }\n  end   \n\n  describe \"This test requires a Manual Review: Ensure any information defined as requiring protection \n  is encrypted in a manner that provides the required level of protection and is physically secured to\n  the required level \" do\n    skip \"This test requires a Manual Review: Ensure any information defined as requiring protection \n    is encrypted in a manner that provides the required level of protection and is physically secured to\n    the required level\"\n  end \n     \n  describe \"This test requires a Manual Review: Verify if encryption at rest is required \n  that encryption tools are installed on the server\" do\n    skip \"This test requires a Manual Review: Verify if encryption at rest is required \n    that encryption tools are installed on the server\"\n  end\nend\n","source_location":{"line":3,"ref":"/home/ubuntu/Desktop/couchbase-enterprise-srg-baseline/controls/V-58171.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Couchbase should have SSL enabled state is expected to eq \"enable\"","run_time":0.644408514,"start_time":"2020-09-22T13:06:31-04:00","message":"\nexpected: \"enable\"\n     got: \"disable\"\n\n(compared using ==)\n"},{"status":"skipped","code_desc":"This test requires a Manual Review: Ensure any information defined as requiring protection \n  is encrypted in a manner that provides the required level of protection and is physically secured to\n  the required level ","run_time":5.72e-06,"start_time":"2020-09-22T13:06:32-04:00","resource":"","skip_message":"This test requires a Manual Review: Ensure any information defined as requiring protection \n    is encrypted in a manner that provides the required level of protection and is physically secured to\n    the required level"},{"status":"skipped","code_desc":"This test requires a Manual Review: Verify if encryption at rest is required \n  that encryption tools are installed on the server","run_time":3.47e-06,"start_time":"2020-09-22T13:06:32-04:00","resource":"","skip_message":"This test requires a Manual Review: Verify if encryption at rest is required \n    that encryption tools are installed on the server"}]},{"id":"V-58151","title":"Access to database files must be limited to relevant processes and to\n  authorized, administrative users.","desc":"Applications, including Couchbases, must prevent unauthorized and\n  unintended information transfer via shared system resources. Permitting only\n  Couchbase processes and authorized, administrative users to have access to the\n  files where the database resides helps ensure that those files are not shared\n  inappropriately and are not open to backdoor access and manipulation.","descriptions":[{"label":"default","data":"Applications, including Couchbases, must prevent unauthorized and\n  unintended information transfer via shared system resources. Permitting only\n  Couchbase processes and authorized, administrative users to have access to the\n  files where the database resides helps ensure that those files are not shared\n  inappropriately and are not open to backdoor access and manipulation."},{"label":"check","data":"Review the permissions granted to users by the operating system/file system\non the database files, database log files and database backup files.\nTo verify that all files are owned by the database administrator and have\nthe correct permissions, run the following:\n  $ ls -lR /opt/couchbase/var/lib/couchbase/data\n  $ ls -lR /opt/couchbase/etc/couchbase/static_config\n  $ ls -IR /opt/couchbase/var/lib/couchbase/logs\n  If any files are not owned by couchbase or allow anyone but the couchbase\nto read/write/execute, this is a finding.\nIf any user/role who is not an authorized system administrator with a need\nto know or database administrator with a need to know, or a system account for\nrunning Couchbase processes, is permitted to read/view any of these files, this\nis a finding."},{"label":"fix","data":"Configure the permissions granted by the operating system/file system on\nthe database files, database log files, and database backup files so that only\nrelevant system accounts and authorized system administrators and database\nadministrators with a need to know are permitted to read/view these files.\nAny files (for example: extra configuration files) created in the\ninstallation directories must be owned by the authorized system accounts, with\nonly owner permissions to read, write, and execute.\nCouchbase configuration files directory:\n  $ chown -R couchbase:couchbase /opt/couchbase/etc/couchbase\n  $ chmod 700 /opt/couchbase/etc/couchbase\nCouchbase default directory (contains data and logs):\n  $ chown -R couchbase:couchbase /opt/couchbase/var/lib/couchbase\n  $ chmod -R 700 /opt/couchbase/var/lib/couchbase\nCouchbase default directory (contains data and logs):\n  $ chown -R couchbase:couchbase /opt/couchbase/var/lib/couchbase\n  $ chmod -R 700 /opt/couchbase/var/lib/couchbase/static_config"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000243-DB-000374","gid":"V-58151","rid":"SV-72581r1_rule","stig_id":"SRG-APP-000243-DB-000374","fix_id":"F-63359r1_fix","cci":["CCI-001090"],"nist":["SC-4","Rev_4"]},"code":"control \"V-58151\" do\n  title \"Access to database files must be limited to relevant processes and to\n  authorized, administrative users.\"\n  desc  \"Applications, including Couchbases, must prevent unauthorized and\n  unintended information transfer via shared system resources. Permitting only\n  Couchbase processes and authorized, administrative users to have access to the\n  files where the database resides helps ensure that those files are not shared\n  inappropriately and are not open to backdoor access and manipulation.\n  \"\n  desc  \"check\", \"\n  Review the permissions granted to users by the operating system/file system\n  on the database files, database log files and database backup files.\n  To verify that all files are owned by the database administrator and have\n  the correct permissions, run the following:\n    $ ls -lR /opt/couchbase/var/lib/couchbase/data\n    $ ls -lR /opt/couchbase/etc/couchbase/static_config\n    $ ls -IR /opt/couchbase/var/lib/couchbase/logs\n    If any files are not owned by couchbase or allow anyone but the couchbase\n  to read/write/execute, this is a finding.\n  If any user/role who is not an authorized system administrator with a need\n  to know or database administrator with a need to know, or a system account for\n  running Couchbase processes, is permitted to read/view any of these files, this\n  is a finding.\n  \"\n  desc  \"fix\", \"\n  Configure the permissions granted by the operating system/file system on\n  the database files, database log files, and database backup files so that only\n  relevant system accounts and authorized system administrators and database\n  administrators with a need to know are permitted to read/view these files.\n  Any files (for example: extra configuration files) created in the\n  installation directories must be owned by the authorized system accounts, with\n  only owner permissions to read, write, and execute.\n  Couchbase configuration files directory:\n    $ chown -R couchbase:couchbase /opt/couchbase/etc/couchbase\n    $ chmod 700 /opt/couchbase/etc/couchbase\n  Couchbase default directory (contains data and logs):\n    $ chown -R couchbase:couchbase /opt/couchbase/var/lib/couchbase\n    $ chmod -R 700 /opt/couchbase/var/lib/couchbase\n  Couchbase default directory (contains data and logs):\n    $ chown -R couchbase:couchbase /opt/couchbase/var/lib/couchbase\n    $ chmod -R 700 /opt/couchbase/var/lib/couchbase/static_config\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000243-DB-000374\"\n  tag \"gid\": \"V-58151\"\n  tag \"rid\": \"SV-72581r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000243-DB-000374\"\n  tag \"fix_id\": \"F-63359r1_fix\"\n  tag \"cci\": [\"CCI-001090\"]\n  tag \"nist\": [\"SC-4\", \"Rev_4\"]\n\n  describe file(input('cb_static_config')) do\n    its('owner') { should eq 'couchbase' }\n    its('group') { should eq 'couchbase' }\n    it { should_not be_more_permissive_than('0600') }\n  end   \n\n  describe directory(input('cb_data_dir')) do\n    it { should be_directory }\n    its('owner') { should eq 'couchbase' }\n    its('group') { should eq 'couchbase' }\n    it { should_not be_more_permissive_than('0700') }\n  end\n\n  describe directory(input('cb_log_dir')) do\n    it { should be_directory }\n    its('owner') { should eq 'couchbase' }\n    its('group') { should eq 'couchbase' }\n    it { should_not be_more_permissive_than('0700') }\n  end   \nend\n","source_location":{"line":3,"ref":"/home/ubuntu/Desktop/couchbase-enterprise-srg-baseline/controls/V-58151.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"File /opt/couchbase/etc/couchbase/static_config is expected not to be more permissive than \"0600\"","run_time":0.308933907,"start_time":"2020-09-22T13:06:32-04:00","message":"expected `File /opt/couchbase/etc/couchbase/static_config.more_permissive_than?(\"0600\")` to return false, got true"},{"status":"passed","code_desc":"File /opt/couchbase/etc/couchbase/static_config owner is expected to eq \"couchbase\"","run_time":0.00015548,"start_time":"2020-09-22T13:06:32-04:00"},{"status":"passed","code_desc":"File /opt/couchbase/etc/couchbase/static_config group is expected to eq \"couchbase\"","run_time":0.000103401,"start_time":"2020-09-22T13:06:32-04:00"},{"status":"passed","code_desc":"Directory /opt/couchbase/var/lib/couchbase/data is expected to be directory","run_time":0.232969332,"start_time":"2020-09-22T13:06:32-04:00"},{"status":"failed","code_desc":"Directory /opt/couchbase/var/lib/couchbase/data is expected not to be more permissive than \"0700\"","run_time":0.167789508,"start_time":"2020-09-22T13:06:32-04:00","message":"expected `Directory /opt/couchbase/var/lib/couchbase/data.more_permissive_than?(\"0700\")` to return false, got true"},{"status":"passed","code_desc":"Directory /opt/couchbase/var/lib/couchbase/data owner is expected to eq \"couchbase\"","run_time":0.00014123,"start_time":"2020-09-22T13:06:33-04:00"},{"status":"passed","code_desc":"Directory /opt/couchbase/var/lib/couchbase/data group is expected to eq \"couchbase\"","run_time":9.502e-05,"start_time":"2020-09-22T13:06:33-04:00"},{"status":"passed","code_desc":"Directory /opt/couchbase/var/lib/couchbase/logs is expected to be directory","run_time":0.200299109,"start_time":"2020-09-22T13:06:33-04:00"},{"status":"passed","code_desc":"Directory /opt/couchbase/var/lib/couchbase/logs is expected not to be more permissive than \"0700\"","run_time":0.172509067,"start_time":"2020-09-22T13:06:33-04:00"},{"status":"passed","code_desc":"Directory /opt/couchbase/var/lib/couchbase/logs owner is expected to eq \"couchbase\"","run_time":0.00016297,"start_time":"2020-09-22T13:06:33-04:00"},{"status":"passed","code_desc":"Directory /opt/couchbase/var/lib/couchbase/logs group is expected to eq \"couchbase\"","run_time":8.6681e-05,"start_time":"2020-09-22T13:06:33-04:00"}]},{"id":"V-58161","title":"Couchbase must implement NIST FIPS 140-2 validated cryptographic\n  modules to generate and validate cryptographic hashes.","desc":"Use of weak or untested encryption algorithms undermines the purposes\n  of utilizing encryption to protect data. The application must implement\n  cryptographic modules adhering to the higher standards approved by the federal\n  government since this provides assurance they have been tested and validated.\n\n  For detailed information, refer to NIST FIPS Publication 140-2, Security\n  Requirements For Cryptographic Modules. Note that the product's cryptographic\n  modules must be validated and certified by NIST as FIPS-compliant.","descriptions":[{"label":"default","data":"Use of weak or untested encryption algorithms undermines the purposes\n  of utilizing encryption to protect data. The application must implement\n  cryptographic modules adhering to the higher standards approved by the federal\n  government since this provides assurance they have been tested and validated.\n\n  For detailed information, refer to NIST FIPS Publication 140-2, Security\n  Requirements For Cryptographic Modules. Note that the product's cryptographic\n  modules must be validated and certified by NIST as FIPS-compliant."},{"label":"check","data":"As the system administrator, run the following:\n  $ openssl version\n\nIf \"fips\" is not included in the openssl version, this is a finding."},{"label":"fix","data":"Configure OpenSSL to meet FIPS Compliance.\n\nTo configure OpenSSL to be FIPS 140-2 compliant, see the official RHEL\nDocumentation:\nhttps://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/sect-Security_Guide-Federal_Standards_And_Regulations-Federal_Information_Processing_Standard.html"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000514-DB-000382","gid":"V-58161","rid":"SV-72591r1_rule","stig_id":"SRG-APP-000514-DB-000382","fix_id":"F-63369r2_fix","cci":["CCI-002450"],"nist":["SC-13","Rev_4"]},"code":"control \"V-58161\" do\n  title \"Couchbase must implement NIST FIPS 140-2 validated cryptographic\n  modules to generate and validate cryptographic hashes.\"\n  desc  \"Use of weak or untested encryption algorithms undermines the purposes\n  of utilizing encryption to protect data. The application must implement\n  cryptographic modules adhering to the higher standards approved by the federal\n  government since this provides assurance they have been tested and validated.\n\n  For detailed information, refer to NIST FIPS Publication 140-2, Security\n  Requirements For Cryptographic Modules. Note that the product's cryptographic\n  modules must be validated and certified by NIST as FIPS-compliant.\n  \"\n  desc  \"check\", \"\n  As the system administrator, run the following:\n    $ openssl version\n  \n  If \\\"fips\\\" is not included in the openssl version, this is a finding.\n  \"\n  desc  \"fix\", \"\n  Configure OpenSSL to meet FIPS Compliance.\n  \n  To configure OpenSSL to be FIPS 140-2 compliant, see the official RHEL\n  Documentation:\n  https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/sect-Security_Guide-Federal_Standards_And_Regulations-Federal_Information_Processing_Standard.html\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000514-DB-000382\"\n  tag \"gid\": \"V-58161\"\n  tag \"rid\": \"SV-72591r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000514-DB-000382\"\n  tag \"fix_id\": \"F-63369r2_fix\"\n  tag \"cci\": [\"CCI-002450\"]\n  tag \"nist\": [\"SC-13\", \"Rev_4\"]\n\n  describe command('openssl version') do\n    its('stdout') { should include 'fips' }\n  end\n  \n  describe kernel_parameter('crypto.fips_enabled') do\n    its('value') { should cmp 1 }\n  end \nend\n","source_location":{"line":3,"ref":"/home/ubuntu/Desktop/couchbase-enterprise-srg-baseline/controls/V-58161.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Command: `openssl version` stdout is expected to include \"fips\"","run_time":0.164596132,"start_time":"2020-09-22T13:06:33-04:00","message":"expected \"OpenSSL 1.0.2g  1 Mar 2016\\n\" to include \"fips\"\nDiff:\n@@ -1 +1 @@\n-fips\n+OpenSSL 1.0.2g  1 Mar 2016\n"},{"status":"failed","code_desc":"Kernel Parameter crypto.fips_enabled value is expected to cmp == 1","run_time":0.251917591,"start_time":"2020-09-22T13:06:33-04:00","message":"\nexpected: 1\n     got: \n\n(compared using `cmp` matcher)\n"}]},{"id":"V-58177","title":"Security-relevant software updates to Couchbase must be installed\n  within the time period directed by an authoritative source (e.g. IAVM, CTOs,\n  DTMs, and STIGs).","desc":"Security flaws with software applications, including database\n  management systems, are discovered daily. Vendors are constantly updating and\n  patching their products to address newly discovered security vulnerabilities.\n  Organizations (including any contractor to the organization) are required to\n  promptly install security-relevant software updates (e.g., patches, service\n  packs, and hot fixes). Flaws discovered during security assessments, continuous\n  monitoring, incident response activities, or information system error handling\n  must also be addressed expeditiously.\n\n  Organization-defined time periods for updating security-relevant software\n  may vary based on a variety of factors including, for example, the security\n  category of the information system or the criticality of the update (i.e.,\n  severity of the vulnerability related to the discovered flaw).\n\n  This requirement will apply to software patch management solutions that are\n  used to install patches across the enclave and also to applications themselves\n  that are not part of that patch management solution. For example, many browsers\n  today provide the capability to install their own patch software. Patch\n  criticality, as well as system criticality, will vary. Therefore, the tactical\n  situations regarding the patch management process will also vary. This means\n  that the time period utilized must be a configurable parameter. Time frames for\n  application of security-relevant software updates may be dependent upon the\n  Information Assurance Vulnerability Management (IAVM) process.\n\n  The application will be configured to check for and install\n  security-relevant software updates within an identified time period from the\n  availability of the update. The specific time period will be defined by an\n  authoritative source (e.g. IAVM, CTOs, DTMs, and STIGs).","descriptions":[{"label":"default","data":"Security flaws with software applications, including database\n  management systems, are discovered daily. Vendors are constantly updating and\n  patching their products to address newly discovered security vulnerabilities.\n  Organizations (including any contractor to the organization) are required to\n  promptly install security-relevant software updates (e.g., patches, service\n  packs, and hot fixes). Flaws discovered during security assessments, continuous\n  monitoring, incident response activities, or information system error handling\n  must also be addressed expeditiously.\n\n  Organization-defined time periods for updating security-relevant software\n  may vary based on a variety of factors including, for example, the security\n  category of the information system or the criticality of the update (i.e.,\n  severity of the vulnerability related to the discovered flaw).\n\n  This requirement will apply to software patch management solutions that are\n  used to install patches across the enclave and also to applications themselves\n  that are not part of that patch management solution. For example, many browsers\n  today provide the capability to install their own patch software. Patch\n  criticality, as well as system criticality, will vary. Therefore, the tactical\n  situations regarding the patch management process will also vary. This means\n  that the time period utilized must be a configurable parameter. Time frames for\n  application of security-relevant software updates may be dependent upon the\n  Information Assurance Vulnerability Management (IAVM) process.\n\n  The application will be configured to check for and install\n  security-relevant software updates within an identified time period from the\n  availability of the update. The specific time period will be defined by an\n  authoritative source (e.g. IAVM, CTOs, DTMs, and STIGs)."},{"label":"check","data":"Obtain evidence that software patches are consistently applied to Couchbase\nwithin the time frame defined for each patch.\n\nTo list the current version of Couchbase installed:\n  $ couchbase-server -v\n\nVerify the version is the most recent available by visiting the following link:\nhttps://docs.couchbase.com/server/current/release-notes/relnotes.html\n\nIf the current Couchbase version is not the latest this is a finding."},{"label":"fix","data":"Institute and adhere to policies and procedures to ensure that patches are\nconsistently applied to Couchbase within the time allowed."}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000456-DB-000390","gid":"V-58177","rid":"SV-72607r1_rule","stig_id":"SRG-APP-000456-DB-000390","fix_id":"F-63385r1_fix","cci":["CCI-002605"],"nist":["SI-2 c","Rev_4"]},"code":"control \"V-58177\" do\n  title \"Security-relevant software updates to Couchbase must be installed\n  within the time period directed by an authoritative source (e.g. IAVM, CTOs,\n  DTMs, and STIGs).\"\n  desc  \"Security flaws with software applications, including database\n  management systems, are discovered daily. Vendors are constantly updating and\n  patching their products to address newly discovered security vulnerabilities.\n  Organizations (including any contractor to the organization) are required to\n  promptly install security-relevant software updates (e.g., patches, service\n  packs, and hot fixes). Flaws discovered during security assessments, continuous\n  monitoring, incident response activities, or information system error handling\n  must also be addressed expeditiously.\n\n  Organization-defined time periods for updating security-relevant software\n  may vary based on a variety of factors including, for example, the security\n  category of the information system or the criticality of the update (i.e.,\n  severity of the vulnerability related to the discovered flaw).\n\n  This requirement will apply to software patch management solutions that are\n  used to install patches across the enclave and also to applications themselves\n  that are not part of that patch management solution. For example, many browsers\n  today provide the capability to install their own patch software. Patch\n  criticality, as well as system criticality, will vary. Therefore, the tactical\n  situations regarding the patch management process will also vary. This means\n  that the time period utilized must be a configurable parameter. Time frames for\n  application of security-relevant software updates may be dependent upon the\n  Information Assurance Vulnerability Management (IAVM) process.\n\n  The application will be configured to check for and install\n  security-relevant software updates within an identified time period from the\n  availability of the update. The specific time period will be defined by an\n  authoritative source (e.g. IAVM, CTOs, DTMs, and STIGs).\n  \"\n  desc  \"check\", \"\n  Obtain evidence that software patches are consistently applied to Couchbase\n  within the time frame defined for each patch.\n  \n  To list the current version of Couchbase installed:\n    $ couchbase-server -v\n  \n  Verify the version is the most recent available by visiting the following link:\n  https://docs.couchbase.com/server/current/release-notes/relnotes.html\n  \n  If the current Couchbase version is not the latest this is a finding.\n  \"\n  desc  \"fix\", \"\n  Institute and adhere to policies and procedures to ensure that patches are\n  consistently applied to Couchbase within the time allowed.\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000456-DB-000390\"\n  tag \"gid\": \"V-58177\"\n  tag \"rid\": \"SV-72607r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000456-DB-000390\"\n  tag \"fix_id\": \"F-63385r1_fix\"\n  tag \"cci\": [\"CCI-002605\"]\n  tag \"nist\": [\"SI-2 c\", \"Rev_4\"]\n\n  describe \"Couchbases server version should match the latest reported version.\" do\n    subject { command(\"couchbase-server -v | egrep -o '[0-9].*-[0-9]' | cut -f1,2 -d'.'\") }\n      its('stdout') { should match input('cb_latest_version')}\n  end  \nend\n","source_location":{"line":3,"ref":"/home/ubuntu/Desktop/couchbase-enterprise-srg-baseline/controls/V-58177.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Couchbases server version should match the latest reported version. stdout is expected to match \"6.6\"","run_time":0.151146793,"start_time":"2020-09-22T13:06:33-04:00","message":"expected \"6.0\\n\" to match \"6.6\"\nDiff:\n@@ -1 +1 @@\n-6.6\n+6.0\n"}]},{"id":"V-58159","title":"Couchbase must implement NIST FIPS 140-2 validated cryptographic\n  modules to provision digital signatures.","desc":"Use of weak or untested encryption algorithms undermines the purposes\n  of utilizing encryption to protect data. The application must implement\n  cryptographic modules adhering to the higher standards approved by the federal\n  government since this provides assurance they have been tested and validated.\n\n  For detailed information, refer to NIST FIPS Publication 140-2, Security\n  Requirements For Cryptographic Modules. Note that the product's cryptographic\n  modules must be validated and certified by NIST as FIPS-compliant.","descriptions":[{"label":"default","data":"Use of weak or untested encryption algorithms undermines the purposes\n  of utilizing encryption to protect data. The application must implement\n  cryptographic modules adhering to the higher standards approved by the federal\n  government since this provides assurance they have been tested and validated.\n\n  For detailed information, refer to NIST FIPS Publication 140-2, Security\n  Requirements For Cryptographic Modules. Note that the product's cryptographic\n  modules must be validated and certified by NIST as FIPS-compliant."},{"label":"check","data":"As the system administrator, run the following:\n  $ openssl version\n\nIf \"fips\" is not included in the openssl version, this is a finding."},{"label":"fix","data":"Configure OpenSSL to meet FIPS Compliance.\nTo configure OpenSSL to be FIPS 140-2 compliant, see the official RHEL\nDocumentation:\nhttps://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/sect-Security_Guide-Federal_Standards_And_Regulations-Federal_Information_Processing_Standard.html"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000514-DB-000381","gid":"V-58159","rid":"SV-72589r1_rule","stig_id":"SRG-APP-000514-DB-000381","fix_id":"F-63367r2_fix","cci":["CCI-002450"],"nist":["SC-13","Rev_4"]},"code":"control \"V-58159\" do\n  title \"Couchbase must implement NIST FIPS 140-2 validated cryptographic\n  modules to provision digital signatures.\"\n  desc  \"Use of weak or untested encryption algorithms undermines the purposes\n  of utilizing encryption to protect data. The application must implement\n  cryptographic modules adhering to the higher standards approved by the federal\n  government since this provides assurance they have been tested and validated.\n\n  For detailed information, refer to NIST FIPS Publication 140-2, Security\n  Requirements For Cryptographic Modules. Note that the product's cryptographic\n  modules must be validated and certified by NIST as FIPS-compliant.\n  \"\n  desc  \"check\", \"\n  As the system administrator, run the following:\n    $ openssl version\n  \n  If \\\"fips\\\" is not included in the openssl version, this is a finding.\n  \"\n  desc  \"fix\", \"\n  Configure OpenSSL to meet FIPS Compliance.\n  To configure OpenSSL to be FIPS 140-2 compliant, see the official RHEL\n  Documentation:\n  https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/sect-Security_Guide-Federal_Standards_And_Regulations-Federal_Information_Processing_Standard.html\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000514-DB-000381\"\n  tag \"gid\": \"V-58159\"\n  tag \"rid\": \"SV-72589r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000514-DB-000381\"\n  tag \"fix_id\": \"F-63367r2_fix\"\n  tag \"cci\": [\"CCI-002450\"]\n  tag \"nist\": [\"SC-13\", \"Rev_4\"]\n\n  describe command('openssl version') do\n    its('stdout') { should include 'fips' }\n  end\n  \n  describe kernel_parameter('crypto.fips_enabled') do\n    its('value') { should cmp 1 }\n  end\nend\n","source_location":{"line":3,"ref":"/home/ubuntu/Desktop/couchbase-enterprise-srg-baseline/controls/V-58159.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Command: `openssl version` stdout is expected to include \"fips\"","run_time":0.174350883,"start_time":"2020-09-22T13:06:33-04:00","message":"expected \"OpenSSL 1.0.2g  1 Mar 2016\\n\" to include \"fips\"\nDiff:\n@@ -1 +1 @@\n-fips\n+OpenSSL 1.0.2g  1 Mar 2016\n"},{"status":"failed","code_desc":"Kernel Parameter crypto.fips_enabled value is expected to cmp == 1","run_time":0.199253817,"start_time":"2020-09-22T13:06:34-04:00","message":"\nexpected: 1\n     got: \n\n(compared using `cmp` matcher)\n"}]},{"id":"V-58167","title":"Couchbase must only accept end entity certificates issued by DoD PKI or\n  DoD-approved PKI Certification Authorities (CAs) for the establishment of all\n  encrypted sessions.","desc":"Only DoD-approved external PKIs have been evaluated to ensure that\n  they have security controls and identity vetting procedures in place which are\n  sufficient for DoD systems to rely on the identity asserted in the certificate.\n  PKIs lacking sufficient security controls and identity vetting procedures risk\n  being compromised and issuing certificates that enable adversaries to\n  impersonate legitimate users.\n  \n  The authoritative list of DoD-approved PKIs is published at\n  http://iase.disa.mil/pki-pke/interoperability.\n  \n  This requirement focuses on communications protection for Couchbase session\n  rather than for the network packet.","descriptions":[{"label":"default","data":"Only DoD-approved external PKIs have been evaluated to ensure that\n  they have security controls and identity vetting procedures in place which are\n  sufficient for DoD systems to rely on the identity asserted in the certificate.\n  PKIs lacking sufficient security controls and identity vetting procedures risk\n  being compromised and issuing certificates that enable adversaries to\n  impersonate legitimate users.\n  \n  The authoritative list of DoD-approved PKIs is published at\n  http://iase.disa.mil/pki-pke/interoperability.\n  \n  This requirement focuses on communications protection for Couchbase session\n  rather than for the network packet."},{"label":"check","data":"If Couchbase will accept non-DoD approved PKI end-entity\ncertificates, this is a finding."},{"label":"fix","data":"Revoke trust in any certificates not issued by a DoD-approved\ncertificate authority. \n  $ openssl ca -revoke <cert-locationt>"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000427-DB-000385","gid":"V-58167","rid":"SV-72597r1_rule","stig_id":"SRG-APP-000427-DB-000385","fix_id":"F-63375r3_fix","cci":["CCI-002470"],"nist":["SC-23 (5)","Rev_4"]},"code":"control \"V-58167\" do\n  title \"Couchbase must only accept end entity certificates issued by DoD PKI or\n  DoD-approved PKI Certification Authorities (CAs) for the establishment of all\n  encrypted sessions.\"\n  desc  \"Only DoD-approved external PKIs have been evaluated to ensure that\n  they have security controls and identity vetting procedures in place which are\n  sufficient for DoD systems to rely on the identity asserted in the certificate.\n  PKIs lacking sufficient security controls and identity vetting procedures risk\n  being compromised and issuing certificates that enable adversaries to\n  impersonate legitimate users.\n  \n  The authoritative list of DoD-approved PKIs is published at\n  http://iase.disa.mil/pki-pke/interoperability.\n  \n  This requirement focuses on communications protection for Couchbase session\n  rather than for the network packet.\n  \"\n  desc  \"check\", \"\n  If Couchbase will accept non-DoD approved PKI end-entity\n  certificates, this is a finding.\n  \"\n  desc  \"fix\", \"\n  Revoke trust in any certificates not issued by a DoD-approved\n  certificate authority. \n    $ openssl ca -revoke <cert-locationt>\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000427-DB-000385\"\n  tag \"gid\": \"V-58167\"\n  tag \"rid\": \"SV-72597r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000427-DB-000385\"\n  tag \"fix_id\": \"F-63375r3_fix\"\n  tag \"cci\": [\"CCI-002470\"]\n  tag \"nist\": [\"SC-23 (5)\", \"Rev_4\"]\n\n  certificate_issuer = command(\"openssl x509 -in -text | grep -i 'issuer'\").stdout.split(\"\\n\")\n\n  certificate_issuer.each do |issuer|\n    describe \"The Couchbase certificate issuer should be DoD approved. #{issuer}\" do\n      subject {issuer}  \n      it { should include 'DoD' }\n    end\n  end  \nend\n","source_location":{"line":2,"ref":"/home/ubuntu/Desktop/couchbase-enterprise-srg-baseline/controls/V-58167.rb"},"waiver_data":{},"results":[]}],"status":"loaded","status_message":""}],"statistics":{"duration":2.676527082},"version":"4.23.4"}