{"platform":{"name":"centos","release":"7.8.2003"},"profiles":[{"name":"tests from {:path=>\".Users.chassenfeldt.Documents.GitHub.couchbase-enterprise-srg-baseline.controls.V-58089.rb\"}","sha256":"ad8441e9fa6cb60af29c4fa99cf6a6c4447936fcfcb672c94a27fd240ff4a2b1","title":"tests from {:path=>\"/Users/chassenfeldt/Documents/GitHub/couchbase-enterprise-srg-baseline/controls/V-58089.rb\"}","supports":[],"attributes":[{"name":"cb_service_user","options":{"value":"couchbase"}},{"name":"cb_service_group","options":{"value":"couchbase"}},{"name":"cb_full_admin","options":{"value":"admin"}},{"name":"cb_full_admin_password","options":{"value":"@dminP@asswd2020"}},{"name":"cb_admin_users","options":{"value":["cbadmin"]}},{"name":"cb_users","options":{"value":["cbuser"]}},{"name":"cb_roles","options":{"value":["admin","bucket_admin"]}},{"name":"cb_use_saslauthd","options":{"value":"true"}},{"name":"cb_use_ldap","options":{"value":"false"}},{"name":"cb_use_pki","options":{"value":"true"}},{"name":"cb_auth_domain","options":{"value":"local"}},{"name":"cb_private_key_path","options":{"value":"/etc/ssl/ca.key"}},{"name":"cb_ca_file_path","options":{"value":"/etc/ssl/ca.pem"}},{"name":"cb_home_dir","options":{"value":"/opt/couchbase"}},{"name":"cb_bin_dir","options":{"value":"/opt/couchbase/bin"}},{"name":"cb_config_dir","options":{"value":"opt/couchbase/etc/couchbase"}},{"name":"cb_static_conf","options":{"value":"opt/couchbase/etc/couchbase/static_config"}},{"name":"cb_data_dir","options":{"value":"/opt/couchbase/var/lib/couchbase/data"}},{"name":"cb_log_dir","options":{"value":"/opt/couchbase/var/lib/couchbase/logs"}},{"name":"cb_audit_log","options":{"value":"/opt/couchbase/var/lib/couchbase/logs/audit.log"}},{"name":"cb_samples_dir","options":{"value":"/opt/couchbase/samples"}},{"name":"sample_buckets","options":{"value":["travel-sample","gamesim-sample","beer-sample"]}},{"name":"cb_required_audit_events","options":{"value":["Service configuration change","authentication succeeded","session terminated"]}},{"name":"cb_required_audit_event_ids","options":{"value":["36865","20485","20493","20489"]}},{"name":"cb_cluster_host","options":{"value":"localhost"}},{"name":"cb_cluster_port","options":{"value":"8091"}},{"name":"cb_query_port","options":{"value":"8093"}},{"name":"is_docker","options":{"value":"true"}},{"name":"cb_redhat_approved_packages","options":{"value":["couchbase-release","couchbase-server"]}},{"name":"cb_debian_approved_packages","options":{"value":["couchbase-server"]}},{"name":"approved_ssl_protocol","options":{"value":"tlsv1.2"}},{"name":"approved_ciphers","options":{"value":["TLS_RSA_WITH_AES_128_CBC_SHA","TLS_RSA_WITH_AES_256_CBC_SHA"]}},{"name":"cb_audit_categories_of_information","options":{"value":"false"}}],"groups":[{"id":"V-58089.rb","controls":["V-58089"]}],"controls":[{"id":"V-58089","title":"Couchbase must generate audit records when unsuccessful attempts to\n  modify security objects occur.","desc":"Changes in the database objects (tables, views, procedures, functions)\n  that record and control permissions, privileges, and roles granted to users and\n  roles must be tracked. Without an audit trail, unauthorized changes to the\n  security subsystem could go undetected. The database could be severely\n  compromised or rendered inoperative.\n\n  To aid in diagnosis, it is necessary to keep track of failed attempts in\n  addition to the successful ones.","descriptions":[{"label":"default","data":"Changes in the database objects (tables, views, procedures, functions)\n  that record and control permissions, privileges, and roles granted to users and\n  roles must be tracked. Without an audit trail, unauthorized changes to the\n  security subsystem could go undetected. The database could be severely\n  compromised or rendered inoperative.\n\n  To aid in diagnosis, it is necessary to keep track of failed attempts in\n  addition to the successful ones."},{"label":"check","data":"If the Couchbase architecture makes it impossible for any user, even with\nthe highest privileges, to directly view or directly modify the contents of its\nbuilt-in security objects, and if there are no additional, locally-defined\nsecurity objects in the database(s), this is not a finding.\nIf Couchbase is not capable of this, this is a finding.\n    \nReview Couchbase security and audit configurations to verify that audit\nrecords are produced when the system denies attempts to modify security objects.\nIf they are not produced, this is a finding.\n    \nReview Couchbase security and audit configurations to verify that audit\nrecords are produced when other errors prevent attempts to modify security\nobjects.\nIf they are not produced, this is a finding."},{"label":"fix","data":"Deploy a Couchbase database capable of producing the required audit records\nwhen it denies or fails to complete attempts to modify security objects, such\nas tables, views, procedures, and functions.\n    \nConfigure Couchbase to produce audit records when it denies attempts to\nmodify security objects, to include reads, creations, modifications, and\ndeletions.\n   \nConfigure Couchbase to produce audit records when other errors prevent\nattempts to modify security objects, to include reads, creations,\nmodifications, and deletions."}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000496-DB-000335","gid":"V-58089","rid":"SV-72519r1_rule","stig_id":"SRG-APP-000496-DB-000335","fix_id":"F-63297r1_fix","cci":["CCI-000172"],"nist":["AU-12 c","Rev_4"]},"code":"control \"V-58089\" do\n  title \"Couchbase must generate audit records when unsuccessful attempts to\n  modify security objects occur.\"\n  desc  \"Changes in the database objects (tables, views, procedures, functions)\n  that record and control permissions, privileges, and roles granted to users and\n  roles must be tracked. Without an audit trail, unauthorized changes to the\n  security subsystem could go undetected. The database could be severely\n  compromised or rendered inoperative.\n\n  To aid in diagnosis, it is necessary to keep track of failed attempts in\n  addition to the successful ones.\n  \"\n  desc  \"check\", \"\n  If the Couchbase architecture makes it impossible for any user, even with\n  the highest privileges, to directly view or directly modify the contents of its\n  built-in security objects, and if there are no additional, locally-defined\n  security objects in the database(s), this is not a finding.\n  If Couchbase is not capable of this, this is a finding.\n      \n  Review Couchbase security and audit configurations to verify that audit\n  records are produced when the system denies attempts to modify security objects.\n  If they are not produced, this is a finding.\n      \n  Review Couchbase security and audit configurations to verify that audit\n  records are produced when other errors prevent attempts to modify security\n  objects.\n  If they are not produced, this is a finding.\n  \"\n  desc  \"fix\", \"\n  Deploy a Couchbase database capable of producing the required audit records\n  when it denies or fails to complete attempts to modify security objects, such\n  as tables, views, procedures, and functions.\n      \n  Configure Couchbase to produce audit records when it denies attempts to\n  modify security objects, to include reads, creations, modifications, and\n  deletions.\n     \n  Configure Couchbase to produce audit records when other errors prevent\n  attempts to modify security objects, to include reads, creations,\n  modifications, and deletions.\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000496-DB-000335\"\n  tag \"gid\": \"V-58089\"\n  tag \"rid\": \"SV-72519r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000496-DB-000335\"\n  tag \"fix_id\": \"F-63297r1_fix\"\n  tag \"cci\": [\"CCI-000172\"]\n  tag \"nist\": [\"AU-12 c\", \"Rev_4\"]\n\n  describe \"Couchbase is not currently capable of generating audit records when unsuccessful attempts to \\\n  modify security objects occur.\" do\n    subject{ input('cb_audit_categories_of_information')}\n    it { should eq 'true'}\n  end\nend\n","source_location":{"line":3,"ref":"/Users/chassenfeldt/Documents/GitHub/couchbase-enterprise-srg-baseline/controls/V-58089.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Couchbase is not currently capable of generating audit records when unsuccessful attempts to   modify security objects occur. is expected to eq \"true\"","run_time":0.000178,"start_time":"2020-09-28T22:16:15-04:00","message":"\nexpected: \"true\"\n     got: \"false\"\n\n(compared using ==)\n"}]}],"status":"loaded","status_message":""}],"statistics":{"duration":0.000524},"version":"4.22.22"}