{"platform":{"name":"centos","release":"7.8.2003"},"profiles":[{"name":"tests from {:path=>\".Users.chassenfeldt.Documents.GitHub.couchbase-enterprise-srg-baseline.controls.V-58023.rb\"}","sha256":"683abb73805d2466cc7aa2cf93b3a5f65e00fdfa060b1f4c45fa99083969da3e","title":"tests from {:path=>\"/Users/chassenfeldt/Documents/GitHub/couchbase-enterprise-srg-baseline/controls/V-58023.rb\"}","supports":[],"attributes":[{"name":"cb_service_user","options":{"value":"couchbase"}},{"name":"cb_service_group","options":{"value":"couchbase"}},{"name":"cb_full_admin","options":{"value":"admin"}},{"name":"cb_full_admin_password","options":{"value":"password"}},{"name":"cb_admin_users","options":{"value":["cbadmin"]}},{"name":"cb_users","options":{"value":["cbuser"]}},{"name":"cb_roles","options":{"value":["admin","bucket_admin"]}},{"name":"cb_auth_method","options":{"value":"saslauthd"}},{"name":"cb_home_dir","options":{"value":"/opt/couchbase"}},{"name":"cb_config_dir","options":{"value":"opt/couchbase/etc/couchbase"}},{"name":"cb_static_conf","options":{"value":"opt/couchbase/etc/couchbase/static_config"}},{"name":"cb_data_dir","options":{"value":"/opt/couchbase/var/lib/couchbase/data"}},{"name":"cb_log_dir","options":{"value":"/opt/couchbase/var/lib/couchbase/logs"}},{"name":"cb_audit_log","options":{"value":"/opt/couchbase/var/lib/couchbase/logs/audit.log"}},{"name":"cb_required_audit_events","options":{"value":["Service configuration change","authentication succeeded","session terminated"]}},{"name":"cb_required_audit_event_ids","options":{"value":["36865","20485","20493","20489"]}},{"name":"approved_packages","options":{"value":[""]}},{"name":"cb_cluster_host","options":{"value":"localhost"}},{"name":"cb_cluster_port","options":{"value":"8091"}},{"name":"is_docker","options":{"value":"true"}}],"groups":[{"id":"V-58023.rb","controls":["V-58023"]}],"controls":[{"id":"V-58023","title":"Couchbase must prevent non-privileged users from executing privileged\nfunctions, to include disabling, circumventing, or altering implemented\nsecurity safeguards/countermeasures.","desc":"Preventing non-privileged users from executing privileged functions\nmitigates the risk that unauthorized individuals or processes may gain\nunnecessary access to information or privileges.\n\n    System documentation should include a definition of the functionality\nconsidered privileged.\n\n    Depending on circumstances, privileged functions can include, for example,\nestablishing accounts, performing system integrity checks, or administering\ncryptographic key management activities. Non-privileged users are individuals\nthat do not possess appropriate authorizations. Circumventing intrusion\ndetection and prevention mechanisms or malicious code protection mechanisms are\nexamples of privileged functions that require protection from non-privileged\nusers.\n\n    A privileged function in Couchbase/database context is any operation that\nmodifies the structure of the database, its built-in logic, or its security\nsettings. This would include all Data Definition Language (DDL) statements and\nall security-related statements. In an SQL environment, it encompasses, but is\nnot necessarily limited to:\n    CREATE\n    ALTER\n    DROP\n    GRANT\n    REVOKE\n    DENY\n\n    There may also be Data Manipulation Language (DML) statements that, subject\nto context, should be regarded as privileged. Possible examples include:\n\n    TRUNCATE TABLE;\n    DELETE, or\n    DELETE affecting more than n rows, for some n, or\n    DELETE without a WHERE clause;\n\n    UPDATE or\n    UPDATE affecting more than n rows, for some n, or\n    UPDATE without a WHERE clause;\n\n    any SELECT, INSERT, UPDATE, or DELETE to an application-defined security\ntable executed by other than a security principal.\n\n    Depending on the capabilities of Couchbase and the design of the database\nand associated applications, the prevention of unauthorized use of privileged\nfunctions may be achieved by means of Couchbase security features, database\ntriggers, other mechanisms, or a combination of these.","descriptions":[{"label":"default","data":"Preventing non-privileged users from executing privileged functions\nmitigates the risk that unauthorized individuals or processes may gain\nunnecessary access to information or privileges.\n\n    System documentation should include a definition of the functionality\nconsidered privileged.\n\n    Depending on circumstances, privileged functions can include, for example,\nestablishing accounts, performing system integrity checks, or administering\ncryptographic key management activities. Non-privileged users are individuals\nthat do not possess appropriate authorizations. Circumventing intrusion\ndetection and prevention mechanisms or malicious code protection mechanisms are\nexamples of privileged functions that require protection from non-privileged\nusers.\n\n    A privileged function in Couchbase/database context is any operation that\nmodifies the structure of the database, its built-in logic, or its security\nsettings. This would include all Data Definition Language (DDL) statements and\nall security-related statements. In an SQL environment, it encompasses, but is\nnot necessarily limited to:\n    CREATE\n    ALTER\n    DROP\n    GRANT\n    REVOKE\n    DENY\n\n    There may also be Data Manipulation Language (DML) statements that, subject\nto context, should be regarded as privileged. Possible examples include:\n\n    TRUNCATE TABLE;\n    DELETE, or\n    DELETE affecting more than n rows, for some n, or\n    DELETE without a WHERE clause;\n\n    UPDATE or\n    UPDATE affecting more than n rows, for some n, or\n    UPDATE without a WHERE clause;\n\n    any SELECT, INSERT, UPDATE, or DELETE to an application-defined security\ntable executed by other than a security principal.\n\n    Depending on the capabilities of Couchbase and the design of the database\nand associated applications, the prevention of unauthorized use of privileged\nfunctions may be achieved by means of Couchbase security features, database\ntriggers, other mechanisms, or a combination of these."},{"label":"check","data":"Only a user with Full Admin and Security Admin roles can alter or\nreconfigure the security safeguards.\n    As the Full Admin, get a list of all RBAC users with the following command:\n    $ couchbase-cli user-manage -c  <localhost>:<port>  -u <Full Admin> -p\n<Password> --list\n    If any users have the \"admin\" role or \"security_admin\" role that should\nnot, this is a finding."},{"label":"fix","data":"Remove users who should not have Full Admin or Security Admin role. To\nmanage the roles this can be done by running the following command (Note: Do\nnot include the \"admin\" or the \"security_admin\" role in command):\n    $ couchbase-cli user-manage -c <host>:<port> -u <Full Admin> \\\n     -p <Password> --set --rbac-username <user> --rbac-password <password> \\\n     --rbac-name <name> --roles <roles> \\\n     --auth-domain <domain>"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000340-DB-000304","gid":"V-58023","rid":"SV-72453r1_rule","stig_id":"SRG-APP-000340-DB-000304","fix_id":"F-63231r1_fix","cci":["CCI-002235"],"nist":["AC-6 (10)","Rev_4"]},"code":"control \"V-58023\" do\n  title \"Couchbase must prevent non-privileged users from executing privileged\nfunctions, to include disabling, circumventing, or altering implemented\nsecurity safeguards/countermeasures.\"\n  desc  \"Preventing non-privileged users from executing privileged functions\nmitigates the risk that unauthorized individuals or processes may gain\nunnecessary access to information or privileges.\n\n    System documentation should include a definition of the functionality\nconsidered privileged.\n\n    Depending on circumstances, privileged functions can include, for example,\nestablishing accounts, performing system integrity checks, or administering\ncryptographic key management activities. Non-privileged users are individuals\nthat do not possess appropriate authorizations. Circumventing intrusion\ndetection and prevention mechanisms or malicious code protection mechanisms are\nexamples of privileged functions that require protection from non-privileged\nusers.\n\n    A privileged function in Couchbase/database context is any operation that\nmodifies the structure of the database, its built-in logic, or its security\nsettings. This would include all Data Definition Language (DDL) statements and\nall security-related statements. In an SQL environment, it encompasses, but is\nnot necessarily limited to:\n    CREATE\n    ALTER\n    DROP\n    GRANT\n    REVOKE\n    DENY\n\n    There may also be Data Manipulation Language (DML) statements that, subject\nto context, should be regarded as privileged. Possible examples include:\n\n    TRUNCATE TABLE;\n    DELETE, or\n    DELETE affecting more than n rows, for some n, or\n    DELETE without a WHERE clause;\n\n    UPDATE or\n    UPDATE affecting more than n rows, for some n, or\n    UPDATE without a WHERE clause;\n\n    any SELECT, INSERT, UPDATE, or DELETE to an application-defined security\ntable executed by other than a security principal.\n\n    Depending on the capabilities of Couchbase and the design of the database\nand associated applications, the prevention of unauthorized use of privileged\nfunctions may be achieved by means of Couchbase security features, database\ntriggers, other mechanisms, or a combination of these.\n  \"\n  desc  \"check\", \"\n    Only a user with Full Admin and Security Admin roles can alter or\nreconfigure the security safeguards.\n    As the Full Admin, get a list of all RBAC users with the following command:\n    $ couchbase-cli user-manage -c  <localhost>:<port>  -u <Full Admin> -p\n<Password> --list\n    If any users have the \\\"admin\\\" role or \\\"security_admin\\\" role that should\nnot, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Remove users who should not have Full Admin or Security Admin role. To\nmanage the roles this can be done by running the following command (Note: Do\nnot include the \\\"admin\\\" or the \\\"security_admin\\\" role in command):\n    $ couchbase-cli user-manage -c <host>:<port> -u <Full Admin> \\\\\n     -p <Password> --set --rbac-username <user> --rbac-password <password> \\\\\n     --rbac-name <name> --roles <roles> \\\\\n     --auth-domain <domain>\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000340-DB-000304\"\n  tag \"gid\": \"V-58023\"\n  tag \"rid\": \"SV-72453r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000340-DB-000304\"\n  tag \"fix_id\": \"F-63231r1_fix\"\n  tag \"cci\": [\"CCI-002235\"]\n  tag \"nist\": [\"AC-6 (10)\", \"Rev_4\"]\n\n  admin_users = []\n  json_output = command(\"couchbase-cli user-manage -u #{input('cb_full_admin')} -p #{input('cb_full_admin_password')} --cluster #{input('cb_cluster_host')}:#{input('cb_cluster_port')} --list | grep -B7 -A3 '\\\"role\\\": \\\"admin\\\"' | grep 'id'\").stdout.split(\"\\n\")\n  \n  json_output.each do |output|\n    user = command(\"echo '#{output}' | awk -F '\\\"' '{print $4}'\").stdout.strip\n    admin_users.push(user)\n  end\n\n  admin_users.each do |user|\n    describe 'Each admin user in the list' do\n      subject { user }\n      it { should be_in input('cb_admin_users').uniq.flatten }\n    end\n  end\n  describe file(input('cb_static_conf')) do\n    its('owner') { should be_in input('cb_service_user') }\n    its('group') { should be_in input('cb_service_group') }\n    it { should_not be_more_permissive_than('0600') }\n  end\nend\n","source_location":{"line":3,"ref":"/Users/chassenfeldt/Documents/GitHub/couchbase-enterprise-srg-baseline/controls/V-58023.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"File opt/couchbase/etc/couchbase/static_config is expected not to be more permissive than \"0600\"","run_time":0.073094,"start_time":"2020-09-12T21:17:59-04:00","message":"The fileopt/couchbase/etc/couchbase/static_configdoesn't seem to exist","exception":"Inspec::Exceptions::ResourceFailed","backtrace":["/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/inspec-core-4.22.22/lib/inspec/resources/file.rb:139:in `more_permissive_than?'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-expectations-3.9.2/lib/rspec/matchers/built_in/be.rb:241:in `predicate_matches?'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-expectations-3.9.2/lib/rspec/matchers/built_in/be.rb:199:in `does_not_match?'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-expectations-3.9.2/lib/rspec/expectations/handler.rb:78:in `does_not_match?'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-expectations-3.9.2/lib/rspec/expectations/handler.rb:72:in `block in handle_matcher'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-expectations-3.9.2/lib/rspec/expectations/handler.rb:27:in `with_matcher'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-expectations-3.9.2/lib/rspec/expectations/handler.rb:70:in `handle_matcher'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/memoized_helpers.rb:100:in `should_not'","/Users/chassenfeldt/Documents/GitHub/couchbase-enterprise-srg-baseline/controls/V-58023.rb:99:in `block (3 levels) in load_with_context'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/inspec-core-4.22.22/lib/inspec/runner_rspec.rb:82:in `run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/inspec-core-4.22.22/lib/inspec/runner.rb:165:in `run_tests'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/inspec-core-4.22.22/lib/inspec/runner.rb:136:in `run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/kitchen-inspec-2.0.0/lib/kitchen/verifier/inspec.rb:105:in `call'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:458:in `block in verify_action'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:551:in `synchronize_or_call'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:513:in `block in action'","/opt/chef-workstation/embedded/lib/ruby/2.7.0/benchmark.rb:293:in `measure'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:512:in `action'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:450:in `verify_action'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:381:in `block (2 levels) in transition_to'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/lifecycle_hooks.rb:44:in `run_with_hooks'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:380:in `block in transition_to'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:379:in `each'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:379:in `transition_to'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:161:in `verify'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/command.rb:197:in `public_send'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/command.rb:197:in `run_action_in_thread'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/command.rb:168:in `block (2 levels) in run_action'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/logging-2.3.0/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"]},{"status":"failed","code_desc":"File opt/couchbase/etc/couchbase/static_config owner is expected to be in \"couchbase\"","run_time":0.022686,"start_time":"2020-09-12T21:17:59-04:00","message":"no implicit conversion of nil into String","exception":"TypeError","backtrace":["/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/inspec-core-4.22.22/lib/matchers/matchers.rb:179:in `include?'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/inspec-core-4.22.22/lib/matchers/matchers.rb:179:in `block (2 levels) in <top (required)>'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-expectations-3.9.2/lib/rspec/matchers/dsl.rb:135:in `block (2 levels) in match'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-support-3.9.3/lib/rspec/support.rb:113:in `with_failure_notifier'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-expectations-3.9.2/lib/rspec/matchers/dsl.rb:133:in `block in match'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-expectations-3.9.2/lib/rspec/expectations/handler.rb:50:in `block in handle_matcher'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-expectations-3.9.2/lib/rspec/expectations/handler.rb:27:in `with_matcher'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-expectations-3.9.2/lib/rspec/expectations/handler.rb:48:in `handle_matcher'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-its-1.3.0/lib/rspec/its.rb:159:in `should'","/Users/chassenfeldt/Documents/GitHub/couchbase-enterprise-srg-baseline/controls/V-58023.rb:97:in `block (3 levels) in load_with_context'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/inspec-core-4.22.22/lib/inspec/runner_rspec.rb:82:in `run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/inspec-core-4.22.22/lib/inspec/runner.rb:165:in `run_tests'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/inspec-core-4.22.22/lib/inspec/runner.rb:136:in `run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/kitchen-inspec-2.0.0/lib/kitchen/verifier/inspec.rb:105:in `call'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:458:in `block in verify_action'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:551:in `synchronize_or_call'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:513:in `block in action'","/opt/chef-workstation/embedded/lib/ruby/2.7.0/benchmark.rb:293:in `measure'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:512:in `action'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:450:in `verify_action'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:381:in `block (2 levels) in transition_to'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/lifecycle_hooks.rb:44:in `run_with_hooks'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:380:in `block in transition_to'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:379:in `each'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:379:in `transition_to'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:161:in `verify'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/command.rb:197:in `public_send'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/command.rb:197:in `run_action_in_thread'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/command.rb:168:in `block (2 levels) in run_action'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/logging-2.3.0/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"]},{"status":"failed","code_desc":"File opt/couchbase/etc/couchbase/static_config group is expected to be in \"couchbase\"","run_time":0.000151,"start_time":"2020-09-12T21:17:59-04:00","message":"no implicit conversion of nil into String","exception":"TypeError","backtrace":["/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/inspec-core-4.22.22/lib/matchers/matchers.rb:179:in `include?'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/inspec-core-4.22.22/lib/matchers/matchers.rb:179:in `block (2 levels) in <top (required)>'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-expectations-3.9.2/lib/rspec/matchers/dsl.rb:135:in `block (2 levels) in match'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-support-3.9.3/lib/rspec/support.rb:113:in `with_failure_notifier'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-expectations-3.9.2/lib/rspec/matchers/dsl.rb:133:in `block in match'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-expectations-3.9.2/lib/rspec/expectations/handler.rb:50:in `block in handle_matcher'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-expectations-3.9.2/lib/rspec/expectations/handler.rb:27:in `with_matcher'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-expectations-3.9.2/lib/rspec/expectations/handler.rb:48:in `handle_matcher'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-its-1.3.0/lib/rspec/its.rb:159:in `should'","/Users/chassenfeldt/Documents/GitHub/couchbase-enterprise-srg-baseline/controls/V-58023.rb:98:in `block (3 levels) in load_with_context'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/inspec-core-4.22.22/lib/inspec/runner_rspec.rb:82:in `run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/inspec-core-4.22.22/lib/inspec/runner.rb:165:in `run_tests'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/inspec-core-4.22.22/lib/inspec/runner.rb:136:in `run'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/kitchen-inspec-2.0.0/lib/kitchen/verifier/inspec.rb:105:in `call'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:458:in `block in verify_action'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:551:in `synchronize_or_call'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:513:in `block in action'","/opt/chef-workstation/embedded/lib/ruby/2.7.0/benchmark.rb:293:in `measure'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:512:in `action'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:450:in `verify_action'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:381:in `block (2 levels) in transition_to'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/lifecycle_hooks.rb:44:in `run_with_hooks'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:380:in `block in transition_to'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:379:in `each'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:379:in `transition_to'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/instance.rb:161:in `verify'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/command.rb:197:in `public_send'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/command.rb:197:in `run_action_in_thread'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.6.0/lib/kitchen/command.rb:168:in `block (2 levels) in run_action'","/opt/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/logging-2.3.0/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"]}]}],"status":"loaded","status_message":""}],"statistics":{"duration":0.0991},"version":"4.22.22"}