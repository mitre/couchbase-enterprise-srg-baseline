{"platform":{"name":"ubuntu","release":"16.04"},"profiles":[{"name":"Database_Generic_SRG","version":"0.1.0","sha256":"f83655acf8445fd9b60d87d04a480f1e4efbc9ce978af3c73349c9088a217ab4","title":"Database Security Requirements Guide","maintainer":"The Authors","summary":"The Database Security Requirements Guide (SRG) is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the NIST 800-53 and related documents. Comments or proposed revisions to this document should be sent via e-mail to the following address: disa.stig_spt@mail.mil.","license":"Apache-2.0","copyright":"The Authors","copyright_email":"you@example.com","supports":[],"attributes":[{"name":"cb_service_user","options":{"value":"couchbase"}},{"name":"cb_service_group","options":{"value":"couchbase"}},{"name":"cb_full_admin","options":{"value":"admin"}},{"name":"cb_full_admin_password","options":{"value":"password"}},{"name":"cb_admin_users","options":{"value":["cbadmin"]}},{"name":"cb_users","options":{"value":["cbuser"]}},{"name":"cb_roles","options":{"value":["admin","bucket_admin"]}},{"name":"cb_use_saslauthd","options":{"value":"true"}},{"name":"cb_use_ldap","options":{"value":"false"}},{"name":"cb_use_pki","options":{"value":"true"}},{"name":"cb_auth_domain","options":{"value":"local"}},{"name":"cb_private_key_path","options":{"value":"/etc/ssl/ca.key"}},{"name":"cb_ca_file_path","options":{"value":"/etc/ssl/ca.pem"}},{"name":"cb_auth_method","options":{"value":"saslauthd"}},{"name":"cb_bin_dir","options":{"value":"/opt/couchbase/bin"}},{"name":"cb_home_dir","options":{"value":"/opt/couchbase"}},{"name":"cb_data_dir","options":{"value":"/opt/couchbase/var/lib/couchbase/data"}},{"name":"cb_config_dir","options":{"value":"opt/couchbase/etc/couchbase"}},{"name":"cb_log_dir","options":{"value":"/opt/couchbase/var/lib/couchbase/logs"}},{"name":"cb_audit_log","options":{"value":"/opt/couchbase/var/lib/couchbase/logs/audit.log"}},{"name":"cb_static_config","options":{"value":"/opt/couchbase/etc/couchbase/static_config"}},{"name":"cb_http_access_log","options":{"value":"/opt/couchbase/var/lib/couchbase/logs/http_access.log"}},{"name":"cb_http_access_internal_log","options":{"value":"/opt/couchbase/var/lib/couchbase/logs/ http_access_internal.log"}},{"name":"cb_cluster_host","options":{"value":"localhost"}},{"name":"cb_cluster_port","options":{"value":"8091"}},{"name":"cb_samples_dir","options":{"value":"/opt/couchbase/samples"}},{"name":"sample_buckets","options":{"value":["travel-sample","gamesim-sample","beer-sample"]}},{"name":"cb_required_audit_events","options":{"value":["Service configuration change","authentication succeeded","session terminated"]}},{"name":"cb_required_audit_event_ids","options":{"value":["36865","20493"]}},{"name":"cb_latest_version","options":{"value":"6.6"}},{"name":"cb_redhat_approved_packages","options":{"value":["couchbase-release","couchbase-server"]}},{"name":"cb_debian_approved_packages","options":{"value":["couchbase-server"]}},{"name":"approved_ssl_protocol","options":{"value":"tlsv1.2"}},{"name":"approved_ciphers","options":{"value":["TLS_RSA_WITH_AES_128_CBC_SHA","TLS_RSA_WITH_AES_256_CBC_SHA"]}}],"groups":[{"id":"controls/V-58115.rb","controls":["V-58115"]},{"id":"controls/V-58109.rb","controls":["V-58109"]},{"id":"controls/V-58117.rb","controls":["V-58117"]},{"id":"controls/V-58111.rb","controls":["V-58111"]},{"id":"controls/V-58107.rb","controls":["V-58107"]},{"id":"controls/V-58113.rb","controls":["V-58113"]}],"controls":[{"id":"V-58115","title":"Couchbase must generate audit records for all privileged activities or\n  other system-level access.","desc":"Without tracking privileged activity, it would be difficult to\n  establish, correlate, and investigate the events relating to an incident or\n  identify those responsible for one.\n\n  System documentation should include a definition of the functionality\n  considered privileged.\n\n  A privileged function in this context is any operation that modifies the\n  structure of the database, its built-in logic, or its security settings. This\n  would include all Data Definition Language (DDL) statements and all\n  security-related statements. In an SQL environment, it encompasses, but is not\n  necessarily limited to:\n  - CREATE\n  - ALTER\n  - DROP\n  - GRANT\n  - REVOKE\n  - DENY\n\n  There may also be Data Manipulation Language (DML) statements that, subject\n  to context, should be regarded as privileged. Possible examples in SQL include:\n\n  TRUNCATE TABLE;\n  DELETE, or\n  DELETE affecting more than n rows, for some n, or\n  DELETE without a WHERE clause;\n\n  UPDATE or\n  UPDATE affecting more than n rows, for some n, or\n  UPDATE without a WHERE clause;\n\n  any SELECT, INSERT, UPDATE, or DELETE to an application-defined security\n  table executed by other than a security principal.\n\n  Depending on the capabilities of Couchbase and the design of the database\n  and associated applications, audit logging may be achieved by means of\n  Couchbase auditing features, database triggers, other mechanisms, or a\n  combination of these.\n\n  Note that it is particularly important to audit, and tightly control, any\n  action that weakens the implementation of this requirement itself, since the\n  objective is to have a complete audit trail of all administrative activity.","descriptions":[{"label":"default","data":"Without tracking privileged activity, it would be difficult to\n  establish, correlate, and investigate the events relating to an incident or\n  identify those responsible for one.\n\n  System documentation should include a definition of the functionality\n  considered privileged.\n\n  A privileged function in this context is any operation that modifies the\n  structure of the database, its built-in logic, or its security settings. This\n  would include all Data Definition Language (DDL) statements and all\n  security-related statements. In an SQL environment, it encompasses, but is not\n  necessarily limited to:\n  - CREATE\n  - ALTER\n  - DROP\n  - GRANT\n  - REVOKE\n  - DENY\n\n  There may also be Data Manipulation Language (DML) statements that, subject\n  to context, should be regarded as privileged. Possible examples in SQL include:\n\n  TRUNCATE TABLE;\n  DELETE, or\n  DELETE affecting more than n rows, for some n, or\n  DELETE without a WHERE clause;\n\n  UPDATE or\n  UPDATE affecting more than n rows, for some n, or\n  UPDATE without a WHERE clause;\n\n  any SELECT, INSERT, UPDATE, or DELETE to an application-defined security\n  table executed by other than a security principal.\n\n  Depending on the capabilities of Couchbase and the design of the database\n  and associated applications, audit logging may be achieved by means of\n  Couchbase auditing features, database triggers, other mechanisms, or a\n  combination of these.\n\n  Note that it is particularly important to audit, and tightly control, any\n  action that weakens the implementation of this requirement itself, since the\n  objective is to have a complete audit trail of all administrative activity."},{"label":"check","data":"Once enabled on the cluster, Couchbase auditing provides the following\nfields by default:\n  - \"id\" - ID of Event\n  - \"name\" - Name of Event (can indicate success/failure)\n  - \"description\" - Event Description (can indicate success/failure)\n  - \"filtering_permitted\" - Whether the event is filterable\n  - \"mandatory_fields\" - Includes \"timestamp\" (UTC time and ISO 8601\n    format) and \"user\" fields\n\nAs the Full Admin, create a user account by executing the following command:\n  $couchbase-cli user-manage -c <host>:<port> -u <Full Admin>     -p <Password> --set --rbac-username jdoe --rbac-password cbpass     --rbac-name \"John Doe\" --roles replication_admin     --auth-domain local\n\nAs the Full Admin, delete a user account by executing the following command:\n  $couchbase-cli user-manage -c <host>:<port> -u <Full Admin>     -p <Password> --delete --rbac-username jdoe     --auth-domain local\n\nVerify that the event logged contains a record of the user's creation and deletion.\n  $ cat <Couchbase Home>/var/lib/couchbase/logs/audit.log \n    \nIf the log does not contain the audit record, this is a finding."},{"label":"fix","data":"Enable session auditing on the Couchbase cluster to produce sufficient\ninformation regarding the types of events that have occurred.\n\nCouchbase Server 6.5.0 and earlier -\nAs the Full Admin, execute the following command to enable auditing:\n  $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n  --password <Password> --audit-enabled 1 --audit-log-rotate-interval 604800\n  --audit-log-path /opt/couchbase/var/lib/couchbase/logs\n\nCouchbase Server Version 6.51 and later -\nAs the Full Admin, execute the following command to enable auditing:\n  $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n  --password <Password> --set  --audit-enabled 1 --audit-log-rotate-interval\n  604800 --audit-log-path /opt/couchbase/var/lib/couchbase/logs"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000504-DB-000354","gid":"V-58115","rid":"SV-72545r1_rule","stig_id":"SRG-APP-000504-DB-000354","fix_id":"F-63323r1_fix","cci":["CCI-000172"],"nist":["AU-12 c","Rev_4"]},"code":"control \"V-58115\" do\n  title \"Couchbase must generate audit records for all privileged activities or\n  other system-level access.\"\n  desc  \"Without tracking privileged activity, it would be difficult to\n  establish, correlate, and investigate the events relating to an incident or\n  identify those responsible for one.\n\n  System documentation should include a definition of the functionality\n  considered privileged.\n\n  A privileged function in this context is any operation that modifies the\n  structure of the database, its built-in logic, or its security settings. This\n  would include all Data Definition Language (DDL) statements and all\n  security-related statements. In an SQL environment, it encompasses, but is not\n  necessarily limited to:\n  - CREATE\n  - ALTER\n  - DROP\n  - GRANT\n  - REVOKE\n  - DENY\n\n  There may also be Data Manipulation Language (DML) statements that, subject\n  to context, should be regarded as privileged. Possible examples in SQL include:\n\n  TRUNCATE TABLE;\n  DELETE, or\n  DELETE affecting more than n rows, for some n, or\n  DELETE without a WHERE clause;\n\n  UPDATE or\n  UPDATE affecting more than n rows, for some n, or\n  UPDATE without a WHERE clause;\n\n  any SELECT, INSERT, UPDATE, or DELETE to an application-defined security\n  table executed by other than a security principal.\n\n  Depending on the capabilities of Couchbase and the design of the database\n  and associated applications, audit logging may be achieved by means of\n  Couchbase auditing features, database triggers, other mechanisms, or a\n  combination of these.\n\n  Note that it is particularly important to audit, and tightly control, any\n  action that weakens the implementation of this requirement itself, since the\n  objective is to have a complete audit trail of all administrative activity.\n  \"\n  desc  \"check\", \"\n  Once enabled on the cluster, Couchbase auditing provides the following\n  fields by default:\n    - \\\"id\\\" - ID of Event\n    - \\\"name\\\" - Name of Event (can indicate success/failure)\n    - \\\"description\\\" - Event Description (can indicate success/failure)\n    - \\\"filtering_permitted\\\" - Whether the event is filterable\n    - \\\"mandatory_fields\\\" - Includes \\\"timestamp\\\" (UTC time and ISO 8601\n      format) and \\\"user\\\" fields\n\n  As the Full Admin, create a user account by executing the following command:\n    $couchbase-cli user-manage -c <host>:<port> -u <Full Admin> \\\n    -p <Password> --set --rbac-username jdoe --rbac-password cbpass \\\n    --rbac-name \\\"John Doe\\\" --roles replication_admin \\\n    --auth-domain local\n  \n  As the Full Admin, delete a user account by executing the following command:\n    $couchbase-cli user-manage -c <host>:<port> -u <Full Admin> \\\n    -p <Password> --delete --rbac-username jdoe \\\n    --auth-domain local\n\n  Verify that the event logged contains a record of the user's creation and deletion.\n    $ cat <Couchbase Home>/var/lib/couchbase/logs/audit.log \n      \n  If the log does not contain the audit record, this is a finding.\n  \"\n  desc  \"fix\", \"\n  Enable session auditing on the Couchbase cluster to produce sufficient\n  information regarding the types of events that have occurred.\n\n  Couchbase Server 6.5.0 and earlier -\n  As the Full Admin, execute the following command to enable auditing:\n    $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n    --password <Password> --audit-enabled 1 --audit-log-rotate-interval 604800\n    --audit-log-path /opt/couchbase/var/lib/couchbase/logs\n\n  Couchbase Server Version 6.51 and later -\n  As the Full Admin, execute the following command to enable auditing:\n    $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n    --password <Password> --set  --audit-enabled 1 --audit-log-rotate-interval\n    604800 --audit-log-path /opt/couchbase/var/lib/couchbase/logs\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000504-DB-000354\"\n  tag \"gid\": \"V-58115\"\n  tag \"rid\": \"SV-72545r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000504-DB-000354\"\n  tag \"fix_id\": \"F-63323r1_fix\"\n  tag \"cci\": [\"CCI-000172\"]\n  tag \"nist\": [\"AU-12 c\", \"Rev_4\"]\n  \n  describe \"Create the jdoe user. The\" do \n    subject { command(\"#{input('cb_bin_dir')}/couchbase-cli user-manage \\\n    -c #{input('cb_cluster_host')}:#{input('cb_cluster_port')} \\\n    -u #{input('cb_full_admin')} -p #{input('cb_full_admin_password')} \\\n    --set --rbac-username jdoe --rbac-password cbpass --rbac-name 'John Doe' \\\n    --roles replication_admin --auth-domain local\") }\n    its('exit_status') { should eq 0 }\n  end\n\n  describe \"The logged event should contain record of user creation. The\" do\n    subject { command(\"grep 'jdoe' #{input('cb_audit_log')} | tail -1\") }\n    its('stdout') { should match /\"User was created\"/}\n  end\n\n  describe \"Delete the jdoe user. The\" do \n    subject { command(\"#{input('cb_bin_dir')}/couchbase-cli user-manage \\\n    -c #{input('cb_cluster_host')}:#{input('cb_cluster_port')} \\\n    -u #{input('cb_full_admin')} -p #{input('cb_full_admin_password')} \\\n    --delete --rbac-username jdoe --auth-domain local\") }\n    its('exit_status') { should eq 0 }\n  end \n   \n  describe \"The logged event should contain record of user deletion. The\" do\n    subject { command(\"grep 'jdoe' #{input('cb_audit_log')} | tail -1\") }\n    its('stdout') { should match /\"User was deleted\"/}\n  end\nend\n","source_location":{"line":3,"ref":"/home/ubuntu/Desktop/couchbase-enterprise-srg-baseline/controls/V-58115.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Create the jdoe user. The exit_status is expected to eq 0","run_time":0.264126374,"start_time":"2020-09-23T21:31:40-04:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"},{"status":"failed","code_desc":"The logged event should contain record of user creation. The stdout is expected to match /\"User was created\"/","run_time":0.099977248,"start_time":"2020-09-23T21:31:40-04:00","message":"expected \"\" to match /\"User was created\"/\nDiff:\n@@ -1 +1 @@\n-/\"User was created\"/\n+\"\"\n"},{"status":"failed","code_desc":"Delete the jdoe user. The exit_status is expected to eq 0","run_time":0.220040494,"start_time":"2020-09-23T21:31:40-04:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"},{"status":"failed","code_desc":"The logged event should contain record of user deletion. The stdout is expected to match /\"User was deleted\"/","run_time":0.136894215,"start_time":"2020-09-23T21:31:40-04:00","message":"expected \"\" to match /\"User was deleted\"/\nDiff:\n@@ -1 +1 @@\n-/\"User was deleted\"/\n+\"\"\n"}]},{"id":"V-58109","title":"Couchbase must generate audit records when unsuccessful logons or\n  connection attempts occur.","desc":"For completeness of forensic analysis, it is necessary to track failed\n  attempts to log on to Couchbase. While positive identification may not be\n  possible in a case of failed authentication, as much information as possible\n  about the incident must be captured.","descriptions":[{"label":"default","data":"For completeness of forensic analysis, it is necessary to track failed\n  attempts to log on to Couchbase. While positive identification may not be\n  possible in a case of failed authentication, as much information as possible\n  about the incident must be captured."},{"label":"check","data":"Once enabled on the cluster, Couchbase auditing provides the following\nfields by default:\n  - \"id\" - ID of Event\n  - \"name\" - Name of Event (can indicate success/failure)\n  - \"description\" - Event Description (can indicate success/failure)\n  - \"filtering_permitted\" - Whether the event is filterable\n  - \"mandatory_fields\" - Includes \"timestamp\" (UTC time and ISO 8601\n    format) and \"user\" fields\n\nAs the Full Admin, create a user account by executing the following command:\n  $couchbase-cli user-manage -c <host>:<port> -u <Full Admin>     -p <Password> --set --rbac-username jdoe --rbac-password wrongpassword     --rbac-name \"John Doe\" --roles replication_admin     --auth-domain local\n\nVerify that the event unsuccessful login attempt is audited:\n  $ cat <Couchbase Home>/var/lib/couchbase/logs/audit.log \n    \nIf the log does not contain the audited record, this is a finding."},{"label":"fix","data":"Enable session auditing on the Couchbase cluster to produce sufficient\ninformation regarding the types of events that have occurred.\n\nCouchbase Server 6.5.0 and earlier -\nAs the Full Admin, execute the following command to enable auditing:\n  $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n  --password <Password> --audit-enabled 1 --audit-log-rotate-interval 604800\n  --audit-log-path /opt/couchbase/var/lib/couchbase/logs\n\nCouchbase Server Version 6.51 and later -\nAs the Full Admin, execute the following command to enable auditing:\n  $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n  --password <Password> --set  --audit-enabled 1 --audit-log-rotate-interval\n  604800 --audit-log-path /opt/couchbase/var/lib/couchbase/logs"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000503-DB-000351","gid":"V-58109","rid":"SV-72539r1_rule","stig_id":"SRG-APP-000503-DB-000351","fix_id":"F-63317r1_fix","cci":["CCI-000172"],"nist":["AU-12 c","Rev_4"]},"code":"control \"V-58109\" do\n  title \"Couchbase must generate audit records when unsuccessful logons or\n  connection attempts occur.\"\n  desc  \"For completeness of forensic analysis, it is necessary to track failed\n  attempts to log on to Couchbase. While positive identification may not be\n  possible in a case of failed authentication, as much information as possible\n  about the incident must be captured.\"\n  desc  \"check\", \"\n  Once enabled on the cluster, Couchbase auditing provides the following\n  fields by default:\n    - \\\"id\\\" - ID of Event\n    - \\\"name\\\" - Name of Event (can indicate success/failure)\n    - \\\"description\\\" - Event Description (can indicate success/failure)\n    - \\\"filtering_permitted\\\" - Whether the event is filterable\n    - \\\"mandatory_fields\\\" - Includes \\\"timestamp\\\" (UTC time and ISO 8601\n      format) and \\\"user\\\" fields\n\n  As the Full Admin, create a user account by executing the following command:\n    $couchbase-cli user-manage -c <host>:<port> -u <Full Admin> \\\n    -p <Password> --set --rbac-username jdoe --rbac-password wrongpassword \\\n    --rbac-name \\\"John Doe\\\" --roles replication_admin \\\n    --auth-domain local\n  \n  Verify that the event unsuccessful login attempt is audited:\n    $ cat <Couchbase Home>/var/lib/couchbase/logs/audit.log \n      \n  If the log does not contain the audited record, this is a finding.\n  \"\n  desc  \"fix\", \"\n  Enable session auditing on the Couchbase cluster to produce sufficient\n  information regarding the types of events that have occurred.\n\n  Couchbase Server 6.5.0 and earlier -\n  As the Full Admin, execute the following command to enable auditing:\n    $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n    --password <Password> --audit-enabled 1 --audit-log-rotate-interval 604800\n    --audit-log-path /opt/couchbase/var/lib/couchbase/logs\n\n  Couchbase Server Version 6.51 and later -\n  As the Full Admin, execute the following command to enable auditing:\n    $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n    --password <Password> --set  --audit-enabled 1 --audit-log-rotate-interval\n    604800 --audit-log-path /opt/couchbase/var/lib/couchbase/logs\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000503-DB-000351\"\n  tag \"gid\": \"V-58109\"\n  tag \"rid\": \"SV-72539r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000503-DB-000351\"\n  tag \"fix_id\": \"F-63317r1_fix\"\n  tag \"cci\": [\"CCI-000172\"]\n  tag \"nist\": [\"AU-12 c\", \"Rev_4\"]\n  \n  describe \"Create the jdoe user. The\" do \n    subject { command(\"#{input('cb_bin_dir')}/couchbase-cli user-manage \\\n    -c #{input('cb_cluster_host')}:#{input('cb_cluster_port')} \\\n    -u #{input('cb_full_admin')} -p wrongpassword \\\n    --set --rbac-username jdoe --rbac-password cbpass --rbac-name 'John Doe' \\\n    --roles replication_admin --auth-domain local\") }\n    its('exit_status') { should eq 0 }\n  end\n\n  describe \"The logged event should contain required fields. The\" do\n    subject { command(\"grep 'jdoe' #{input('cb_audit_log')} | tail -1\") }\n    its('stdout') { should match /\"Unsuccessful attempt to login\"/}\n  end\nend\n","source_location":{"line":3,"ref":"/home/ubuntu/Desktop/couchbase-enterprise-srg-baseline/controls/V-58109.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Create the jdoe user. The exit_status is expected to eq 0","run_time":0.229908318,"start_time":"2020-09-23T21:31:41-04:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"},{"status":"failed","code_desc":"The logged event should contain required fields. The stdout is expected to match /\"Unsuccessful attempt to login\"/","run_time":0.162199086,"start_time":"2020-09-23T21:31:41-04:00","message":"expected \"\" to match /\"Unsuccessful attempt to login\"/\nDiff:\n@@ -1 +1 @@\n-/\"Unsuccessful attempt to login\"/\n+\"\"\n"}]},{"id":"V-58117","title":"Couchbase must generate audit records when unsuccessful attempts to\n  execute privileged activities or other system-level access occur.","desc":"Without tracking privileged activity, it would be difficult to\n  establish, correlate, and investigate the events relating to an incident or\n  identify those responsible for one.\n\n  System documentation should include a definition of the functionality\n  considered privileged.\n\n  A privileged function in this context is any operation that modifies the\n  structure of the database, its built-in logic, or its security settings. This\n  would include all Data Definition Language (DDL) statements and all\n  security-related statements. In an SQL environment, it encompasses, but is not\n  necessarily limited to:\n  - CREATE\n  - ALTER\n  - DROP\n  - GRANT\n  - REVOKE\n  - DENY\n\n  Note that it is particularly important to audit, and tightly control, any\n  action that weakens the implementation of this requirement itself, since the\n  objective is to have a complete audit trail of all administrative activity.\n\n  To aid in diagnosis, it is necessary to keep track of failed attempts in\n  addition to the successful ones.","descriptions":[{"label":"default","data":"Without tracking privileged activity, it would be difficult to\n  establish, correlate, and investigate the events relating to an incident or\n  identify those responsible for one.\n\n  System documentation should include a definition of the functionality\n  considered privileged.\n\n  A privileged function in this context is any operation that modifies the\n  structure of the database, its built-in logic, or its security settings. This\n  would include all Data Definition Language (DDL) statements and all\n  security-related statements. In an SQL environment, it encompasses, but is not\n  necessarily limited to:\n  - CREATE\n  - ALTER\n  - DROP\n  - GRANT\n  - REVOKE\n  - DENY\n\n  Note that it is particularly important to audit, and tightly control, any\n  action that weakens the implementation of this requirement itself, since the\n  objective is to have a complete audit trail of all administrative activity.\n\n  To aid in diagnosis, it is necessary to keep track of failed attempts in\n  addition to the successful ones."},{"label":"check","data":"Once enabled on the cluster, Couchbase auditing provides the following\nfields by default:\n  - \"id\" - ID of Event\n  - \"name\" - Name of Event (can indicate success/failure)\n  - \"description\" - Event Description (can indicate success/failure)\n  - \"filtering_permitted\" - Whether the event is filterable\n  - \"mandatory_fields\" - Includes \"timestamp\" (UTC time and ISO 8601\n    format) and \"user\" fields\n\nAs the Full Admin, create a user account by executing the following command:\n  $couchbase-cli user-manage -c <host>:<port> -u <Full Admin>     -p <Password> --set --rbac-username jdoe --rbac-password cbpass     --rbac-name \"John Doe\" --roles ro_admin     --auth-domain local\n\nAs the Jdoe user, try to create a user account by executing the following command:\n  $couchbase-cli user-manage -c <host>:<port> -u jdoe     -p cbpass --set --rbac-username janedoe --rbac-password cbpass     --rbac-name \"Joane Doe\" --roles ro_admin     --auth-domain local\n\nVerify that unsuccessful attempts to create a user is auditted:\n  $ cat <Couchbase Home>/var/lib/couchbase/logs/audit.log \n    \nIf the log does not contain the audit, this is a finding.  \n\nAs the Jdoe user, try to delete a user account by executing the following command:\n$couchbase-cli user-manage -c <host>:<port> -u jdoe   -p cbpass --delete --rbac-username janedoe   --auth-domain local\n\nVerify that unsuccessful attempts to delete a user is auditted:\n  $ cat <Couchbase Home>/var/lib/couchbase/logs/audit.log \n    \nIf the log does not contain the audit, this is a finding."},{"label":"fix","data":"Enable session auditing on the Couchbase cluster to produce sufficient\ninformation regarding the types of events that have occurred.\n\nCouchbase Server 6.5.0 and earlier -\nAs the Full Admin, execute the following command to enable auditing:\n  $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n  --password <Password> --audit-enabled 1 --audit-log-rotate-interval 604800\n  --audit-log-path /opt/couchbase/var/lib/couchbase/logs\n\nCouchbase Server Version 6.51 and later -\nAs the Full Admin, execute the following command to enable auditing:\n  $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n  --password <Password> --set  --audit-enabled 1 --audit-log-rotate-interval\n  604800 --audit-log-path /opt/couchbase/var/lib/couchbase/logs"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000504-DB-000355","gid":"V-58117","rid":"SV-72547r1_rule","stig_id":"SRG-APP-000504-DB-000355","fix_id":"F-63325r1_fix","cci":["CCI-000172"],"nist":["AU-12 c","Rev_4"]},"code":"control \"V-58117\" do\n  title \"Couchbase must generate audit records when unsuccessful attempts to\n  execute privileged activities or other system-level access occur.\"\n  desc  \"Without tracking privileged activity, it would be difficult to\n  establish, correlate, and investigate the events relating to an incident or\n  identify those responsible for one.\n\n  System documentation should include a definition of the functionality\n  considered privileged.\n\n  A privileged function in this context is any operation that modifies the\n  structure of the database, its built-in logic, or its security settings. This\n  would include all Data Definition Language (DDL) statements and all\n  security-related statements. In an SQL environment, it encompasses, but is not\n  necessarily limited to:\n  - CREATE\n  - ALTER\n  - DROP\n  - GRANT\n  - REVOKE\n  - DENY\n\n  Note that it is particularly important to audit, and tightly control, any\n  action that weakens the implementation of this requirement itself, since the\n  objective is to have a complete audit trail of all administrative activity.\n\n  To aid in diagnosis, it is necessary to keep track of failed attempts in\n  addition to the successful ones.\n  \"\n  desc  \"check\", \"\n  Once enabled on the cluster, Couchbase auditing provides the following\n  fields by default:\n    - \\\"id\\\" - ID of Event\n    - \\\"name\\\" - Name of Event (can indicate success/failure)\n    - \\\"description\\\" - Event Description (can indicate success/failure)\n    - \\\"filtering_permitted\\\" - Whether the event is filterable\n    - \\\"mandatory_fields\\\" - Includes \\\"timestamp\\\" (UTC time and ISO 8601\n      format) and \\\"user\\\" fields\n\n  As the Full Admin, create a user account by executing the following command:\n    $couchbase-cli user-manage -c <host>:<port> -u <Full Admin> \\\n    -p <Password> --set --rbac-username jdoe --rbac-password cbpass \\\n    --rbac-name \\\"John Doe\\\" --roles ro_admin \\\n    --auth-domain local\n\n  As the Jdoe user, try to create a user account by executing the following command:\n    $couchbase-cli user-manage -c <host>:<port> -u jdoe \\\n    -p cbpass --set --rbac-username janedoe --rbac-password cbpass \\\n    --rbac-name \\\"Joane Doe\\\" --roles ro_admin \\\n    --auth-domain local\n  \n  Verify that unsuccessful attempts to create a user is auditted:\n    $ cat <Couchbase Home>/var/lib/couchbase/logs/audit.log \n      \n  If the log does not contain the audit, this is a finding.  \n\n  As the Jdoe user, try to delete a user account by executing the following command:\n  $couchbase-cli user-manage -c <host>:<port> -u jdoe \\\n  -p cbpass --delete --rbac-username janedoe \\\n  --auth-domain local\n\n  Verify that unsuccessful attempts to delete a user is auditted:\n    $ cat <Couchbase Home>/var/lib/couchbase/logs/audit.log \n      \n  If the log does not contain the audit, this is a finding. \n  \"\n  desc  \"fix\", \"\n  Enable session auditing on the Couchbase cluster to produce sufficient\n  information regarding the types of events that have occurred.\n\n  Couchbase Server 6.5.0 and earlier -\n  As the Full Admin, execute the following command to enable auditing:\n    $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n    --password <Password> --audit-enabled 1 --audit-log-rotate-interval 604800\n    --audit-log-path /opt/couchbase/var/lib/couchbase/logs\n\n  Couchbase Server Version 6.51 and later -\n  As the Full Admin, execute the following command to enable auditing:\n    $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n    --password <Password> --set  --audit-enabled 1 --audit-log-rotate-interval\n    604800 --audit-log-path /opt/couchbase/var/lib/couchbase/logs\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000504-DB-000355\"\n  tag \"gid\": \"V-58117\"\n  tag \"rid\": \"SV-72547r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000504-DB-000355\"\n  tag \"fix_id\": \"F-63325r1_fix\"\n  tag \"cci\": [\"CCI-000172\"]\n  tag \"nist\": [\"AU-12 c\", \"Rev_4\"]\n\n  describe \"Create the jdoe user. The\" do \n    subject { command(\"#{input('cb_bin_dir')}/couchbase-cli user-manage \\\n    -c #{input('cb_cluster_host')}:#{input('cb_cluster_port')} \\\n    -u #{input('cb_full_admin')} -p #{input('cb_full_admin_password')} \\\n    --set --rbac-username jdoe --rbac-password cbpass --rbac-name 'John Doe' \\\n    --roles ro_admin --auth-domain local\") }\n    its('exit_status') { should eq 0 }\n  end  \n\n  describe \"As jdoe attempt to create the janedoe user. The\" do \n    subject { command(\"#{input('cb_bin_dir')}/couchbase-cli user-manage \\\n    -c #{input('cb_cluster_host')}:#{input('cb_cluster_port')} \\\n    -u #{input('cb_full_admin')} -p #{input('cb_full_admin_password')} \\\n    --set --rbac-username janedoe --rbac-password cbpass --rbac-name 'Jane Doe' \\\n    --roles ro_admin --auth-domain local\") }\n    its('exit_status') { should eq 0 }\n  end  \n\n  describe \"The logged event should contain record of failed user creation. The\" do\n    subject { command(\"grep 'jdoe' #{input('cb_audit_log')} | tail -1\") }\n    its('stdout') { should match /\"Unsuccessful attempt\"/}\n  end\n\n  describe \"As jdoe attempt to delete the janedoe user. The\" do \n    subject { command(\"#{input('cb_bin_dir')}/couchbase-cli user-manage \\\n    -c #{input('cb_cluster_host')}:#{input('cb_cluster_port')} \\\n    -u #{input('cb_full_admin')} -p #{input('cb_full_admin_password')} \\\n    --delete --rbac-username janedoe --auth-domain local\") }\n  end  \n\n  describe \"The logged event should contain record of failed user deletion. The\" do\n    subject { command(\"grep 'jdoe' #{input('cb_audit_log')} | tail -1\") }\n    its('stdout') { should match /\"Unsuccessful attempt\"/}\n  end\n\n  describe \"Delete the jdoe user. The\" do \n    subject { command(\"#{input('cb_bin_dir')}/couchbase-cli user-manage \\\n    -c #{input('cb_cluster_host')}:#{input('cb_cluster_port')} \\\n    -u #{input('cb_full_admin')} -p #{input('cb_full_admin_password')} \\\n    --delete --rbac-username jdoe --auth-domain local\") }\n    its('exit_status') { should eq 0 }\n  end\nend\n","source_location":{"line":3,"ref":"/home/ubuntu/Desktop/couchbase-enterprise-srg-baseline/controls/V-58117.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Create the jdoe user. The exit_status is expected to eq 0","run_time":0.229859876,"start_time":"2020-09-23T21:31:41-04:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"},{"status":"failed","code_desc":"As jdoe attempt to create the janedoe user. The exit_status is expected to eq 0","run_time":0.213784929,"start_time":"2020-09-23T21:31:41-04:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"},{"status":"failed","code_desc":"The logged event should contain record of failed user creation. The stdout is expected to match /\"Unsuccessful attempt\"/","run_time":0.074613664,"start_time":"2020-09-23T21:31:41-04:00","message":"expected \"\" to match /\"Unsuccessful attempt\"/\nDiff:\n@@ -1 +1 @@\n-/\"Unsuccessful attempt\"/\n+\"\"\n"},{"status":"failed","code_desc":"The logged event should contain record of failed user deletion. The stdout is expected to match /\"Unsuccessful attempt\"/","run_time":0.101075696,"start_time":"2020-09-23T21:31:41-04:00","message":"expected \"\" to match /\"Unsuccessful attempt\"/\nDiff:\n@@ -1 +1 @@\n-/\"Unsuccessful attempt\"/\n+\"\"\n"},{"status":"failed","code_desc":"Delete the jdoe user. The exit_status is expected to eq 0","run_time":0.20123885,"start_time":"2020-09-23T21:31:42-04:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"id":"V-58111","title":"Couchbase must generate audit records showing starting and ending time\n  for user access to the database(s).","desc":"For completeness of forensic analysis, it is necessary to know how\n  long a user's (or other principal's) connection to Couchbase lasts. This can be\n  achieved by recording disconnections, in addition to logons/connections, in the\n  audit logs.\n\n      Disconnection may be initiated by the user or forced by the system (as in a\n  timeout) or result from a system or network failure. To the greatest extent\n  possible, all disconnections must be logged.","descriptions":[{"label":"default","data":"For completeness of forensic analysis, it is necessary to know how\n  long a user's (or other principal's) connection to Couchbase lasts. This can be\n  achieved by recording disconnections, in addition to logons/connections, in the\n  audit logs.\n\n      Disconnection may be initiated by the user or forced by the system (as in a\n  timeout) or result from a system or network failure. To the greatest extent\n  possible, all disconnections must be logged."},{"label":"check","data":"Once enabled on the cluster, Couchbase auditing provides the following\nfields by default:\n  - \"id\" - ID of Event\n  - \"name\" - Name of Event (can indicate success/failure)\n  - \"description\" - Event Description (can indicate success/failure)\n  - \"filtering_permitted\" - Whether the event is filterable\n  - \"mandatory_fields\" - Includes \"timestamp\" (UTC time and ISO 8601\n    format) and \"user\" fields\n\nAs the Full Admin, create a user account by executing the following command:\n  $couchbase-cli user-manage -c <host>:<port> -u <Full Admin>     -p <Password> --set --rbac-username jdoe --rbac-password cbpass     --rbac-name \"John Doe\" --roles replication_admin     --auth-domain local\n\nVerify that the event logged contains the required fields:\n  $ cat <Couchbase Home>/var/lib/couchbase/logs/audit.log \n    \nIf the log does not contain the \"timestamp\" field, and \"username\" field\nthis is a finding."},{"label":"fix","data":"Enable session auditing on the Couchbase cluster to produce sufficient\ninformation regarding the types of events that have occurred.\n\nCouchbase Server 6.5.0 and earlier -\nAs the Full Admin, execute the following command to enable auditing:\n  $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n  --password <Password> --audit-enabled 1 --audit-log-rotate-interval 604800\n  --audit-log-path /opt/couchbase/var/lib/couchbase/logs\n\nCouchbase Server Version 6.51 and later -\nAs the Full Admin, execute the following command to enable auditing:\n  $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n  --password <Password> --set  --audit-enabled 1 --audit-log-rotate-interval\n  604800 --audit-log-path /opt/couchbase/var/lib/couchbase/logs"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000505-DB-000352","gid":"V-58111","rid":"SV-72541r1_rule","stig_id":"SRG-APP-000505-DB-000352","fix_id":"F-63319r1_fix","cci":["CCI-000172"],"nist":["AU-12 c","Rev_4"]},"code":"control \"V-58111\" do\n  title \"Couchbase must generate audit records showing starting and ending time\n  for user access to the database(s).\"\n  desc  \"For completeness of forensic analysis, it is necessary to know how\n  long a user's (or other principal's) connection to Couchbase lasts. This can be\n  achieved by recording disconnections, in addition to logons/connections, in the\n  audit logs.\n\n      Disconnection may be initiated by the user or forced by the system (as in a\n  timeout) or result from a system or network failure. To the greatest extent\n  possible, all disconnections must be logged.\n  \"\n  desc  \"check\", \"\n  Once enabled on the cluster, Couchbase auditing provides the following\n  fields by default:\n    - \\\"id\\\" - ID of Event\n    - \\\"name\\\" - Name of Event (can indicate success/failure)\n    - \\\"description\\\" - Event Description (can indicate success/failure)\n    - \\\"filtering_permitted\\\" - Whether the event is filterable\n    - \\\"mandatory_fields\\\" - Includes \\\"timestamp\\\" (UTC time and ISO 8601\n      format) and \\\"user\\\" fields\n\n  As the Full Admin, create a user account by executing the following command:\n    $couchbase-cli user-manage -c <host>:<port> -u <Full Admin> \\\n    -p <Password> --set --rbac-username jdoe --rbac-password cbpass \\\n    --rbac-name \\\"John Doe\\\" --roles replication_admin \\\n    --auth-domain local\n  \n  Verify that the event logged contains the required fields:\n    $ cat <Couchbase Home>/var/lib/couchbase/logs/audit.log \n      \n  If the log does not contain the \\\"timestamp\\\" field, and \\\"username\\\" field\n  this is a finding.\n  \"\n  desc  \"fix\", \"\n  Enable session auditing on the Couchbase cluster to produce sufficient\n  information regarding the types of events that have occurred.\n\n  Couchbase Server 6.5.0 and earlier -\n  As the Full Admin, execute the following command to enable auditing:\n    $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n    --password <Password> --audit-enabled 1 --audit-log-rotate-interval 604800\n    --audit-log-path /opt/couchbase/var/lib/couchbase/logs\n\n  Couchbase Server Version 6.51 and later -\n  As the Full Admin, execute the following command to enable auditing:\n    $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n    --password <Password> --set  --audit-enabled 1 --audit-log-rotate-interval\n    604800 --audit-log-path /opt/couchbase/var/lib/couchbase/logs\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000505-DB-000352\"\n  tag \"gid\": \"V-58111\"\n  tag \"rid\": \"SV-72541r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000505-DB-000352\"\n  tag \"fix_id\": \"F-63319r1_fix\"\n  tag \"cci\": [\"CCI-000172\"]\n  tag \"nist\": [\"AU-12 c\", \"Rev_4\"]\n\n  describe \"Create the jdoe user. The\" do \n    subject { command(\"#{input('cb_bin_dir')}/couchbase-cli user-manage \\\n    -c #{input('cb_cluster_host')}:#{input('cb_cluster_port')} \\\n    -u #{input('cb_full_admin')} -p #{input('cb_full_admin_password')} \\\n    --set --rbac-username jdoe --rbac-password cbpass --rbac-name 'John Doe' \\\n    --roles replication_admin --auth-domain local\") }\n    its('exit_status') { should eq 0 }\n  end\n\n  describe \"The logged event should contain required fields. The\" do\n    subject { command(\"grep 'jdoe' #{input('cb_audit_log')} | tail -1\") }\n    its('stdout') { should match /\"timestamp\"/}\n    its('stdout') { should match /\"username\"/}\n  end\n\n  describe \"Delete the jdoe user. The\" do \n    subject { command(\"#{input('cb_bin_dir')}/couchbase-cli user-manage \\\n    -c #{input('cb_cluster_host')}:#{input('cb_cluster_port')} \\\n    -u #{input('cb_full_admin')} -p #{input('cb_full_admin_password')} \\\n    --delete --rbac-username jdoe --auth-domain local\") }\n    its('exit_status') { should eq 0 }\n  end  \nend\n","source_location":{"line":3,"ref":"/home/ubuntu/Desktop/couchbase-enterprise-srg-baseline/controls/V-58111.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Create the jdoe user. The exit_status is expected to eq 0","run_time":0.193842351,"start_time":"2020-09-23T21:31:42-04:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"},{"status":"failed","code_desc":"The logged event should contain required fields. The stdout is expected to match /\"timestamp\"/","run_time":0.084546791,"start_time":"2020-09-23T21:31:42-04:00","message":"expected \"\" to match /\"timestamp\"/\nDiff:\n@@ -1 +1 @@\n-/\"timestamp\"/\n+\"\"\n"},{"status":"failed","code_desc":"The logged event should contain required fields. The stdout is expected to match /\"username\"/","run_time":0.078843588,"start_time":"2020-09-23T21:31:42-04:00","message":"expected \"\" to match /\"username\"/\nDiff:\n@@ -1 +1 @@\n-/\"username\"/\n+\"\"\n"},{"status":"failed","code_desc":"Delete the jdoe user. The exit_status is expected to eq 0","run_time":0.254502613,"start_time":"2020-09-23T21:31:42-04:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"id":"V-58107","title":"Couchbase must generate audit records when successful logons or\n  connections occur.","desc":"For completeness of forensic analysis, it is necessary to track\n  who/what (a user or other principal) logs on to Couchbase.","descriptions":[{"label":"default","data":"For completeness of forensic analysis, it is necessary to track\n  who/what (a user or other principal) logs on to Couchbase."},{"label":"check","data":"Once enabled on the cluster, Couchbase auditing provides the following\nfields by default:\n  - \"id\" - ID of Event\n  - \"name\" - Name of Event (can indicate success/failure)\n  - \"description\" - Event Description (can indicate success/failure)\n  - \"filtering_permitted\" - Whether the event is filterable\n  - \"mandatory_fields\" - Includes \"timestamp\" (UTC time and ISO 8601\n    format) and \"user\" fields\n\nAs the Full Admin, create a user account by executing the following command:\n  $couchbase-cli user-manage -c <host>:<port> -u <Full Admin>     -p <Password> --set --rbac-username jdoe --rbac-password cbpass     --rbac-name \"John Doe\" --roles replication_admin     --auth-domain local\n\nVerify that the event logged contains audit record of successful logins:\n  $ cat <Couchbase Home>/var/lib/couchbase/logs/audit.log \n    \nIf the log does not contain the audited record, this is a finding."},{"label":"fix","data":"Enable session auditing on the Couchbase cluster to produce sufficient\ninformation regarding the types of events that have occurred.\n\nCouchbase Server 6.5.0 and earlier -\nAs the Full Admin, execute the following command to enable auditing:\n  $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n  --password <Password> --audit-enabled 1 --audit-log-rotate-interval 604800\n  --audit-log-path /opt/couchbase/var/lib/couchbase/logs\n\nCouchbase Server Version 6.51 and later -\nAs the Full Admin, execute the following command to enable auditing:\n  $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n  --password <Password> --set  --audit-enabled 1 --audit-log-rotate-interval\n  604800 --audit-log-path /opt/couchbase/var/lib/couchbase/logs"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000503-DB-000350","gid":"V-58107","rid":"SV-72537r1_rule","stig_id":"SRG-APP-000503-DB-000350","fix_id":"F-63315r1_fix","cci":["CCI-000172"],"nist":["AU-12 c","Rev_4"]},"code":"control \"V-58107\" do\n  title \"Couchbase must generate audit records when successful logons or\n  connections occur.\"\n  desc  \"For completeness of forensic analysis, it is necessary to track\n  who/what (a user or other principal) logs on to Couchbase.\"\n  desc  \"check\", \"\n  Once enabled on the cluster, Couchbase auditing provides the following\n  fields by default:\n    - \\\"id\\\" - ID of Event\n    - \\\"name\\\" - Name of Event (can indicate success/failure)\n    - \\\"description\\\" - Event Description (can indicate success/failure)\n    - \\\"filtering_permitted\\\" - Whether the event is filterable\n    - \\\"mandatory_fields\\\" - Includes \\\"timestamp\\\" (UTC time and ISO 8601\n      format) and \\\"user\\\" fields\n\n  As the Full Admin, create a user account by executing the following command:\n    $couchbase-cli user-manage -c <host>:<port> -u <Full Admin> \\\n    -p <Password> --set --rbac-username jdoe --rbac-password cbpass \\\n    --rbac-name \\\"John Doe\\\" --roles replication_admin \\\n    --auth-domain local\n  \n  Verify that the event logged contains audit record of successful logins:\n    $ cat <Couchbase Home>/var/lib/couchbase/logs/audit.log \n      \n  If the log does not contain the audited record, this is a finding.\n  \"\n  desc  \"fix\", \"\n  Enable session auditing on the Couchbase cluster to produce sufficient\n  information regarding the types of events that have occurred.\n\n  Couchbase Server 6.5.0 and earlier -\n  As the Full Admin, execute the following command to enable auditing:\n    $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n    --password <Password> --audit-enabled 1 --audit-log-rotate-interval 604800\n    --audit-log-path /opt/couchbase/var/lib/couchbase/logs\n\n  Couchbase Server Version 6.51 and later -\n  As the Full Admin, execute the following command to enable auditing:\n    $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n    --password <Password> --set  --audit-enabled 1 --audit-log-rotate-interval\n    604800 --audit-log-path /opt/couchbase/var/lib/couchbase/logs\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000503-DB-000350\"\n  tag \"gid\": \"V-58107\"\n  tag \"rid\": \"SV-72537r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000503-DB-000350\"\n  tag \"fix_id\": \"F-63315r1_fix\"\n  tag \"cci\": [\"CCI-000172\"]\n  tag \"nist\": [\"AU-12 c\", \"Rev_4\"]\n\n  describe \"Create the jdoe user. The\" do \n    subject { command(\"#{input('cb_bin_dir')}/couchbase-cli user-manage \\\n    -c #{input('cb_cluster_host')}:#{input('cb_cluster_port')} \\\n    -u #{input('cb_full_admin')} -p #{input('cb_full_admin_password')} \\\n    --set --rbac-username jdoe --rbac-password cbpass --rbac-name 'John Doe' \\\n    --roles replication_admin --auth-domain local\") }\n    its('exit_status') { should eq 0 }\n  end\n\n  describe \"The logged event should contain required fields. The\" do\n    subject { command(\"grep 'jdoe' #{input('cb_audit_log')} | tail -1\") }\n    its('stdout') { should match /\"Successful login\"/}\n  end\n\n  describe \"Delete the jdoe user. The\" do \n    subject { command(\"#{input('cb_bin_dir')}/couchbase-cli user-manage \\\n    -c #{input('cb_cluster_host')}:#{input('cb_cluster_port')} \\\n    -u #{input('cb_full_admin')} -p #{input('cb_full_admin_password')} \\\n    --delete --rbac-username jdoe --auth-domain local\") }\n    its('exit_status') { should eq 0 }\n  end  \nend\n","source_location":{"line":3,"ref":"/home/ubuntu/Desktop/couchbase-enterprise-srg-baseline/controls/V-58107.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Create the jdoe user. The exit_status is expected to eq 0","run_time":0.25531852,"start_time":"2020-09-23T21:31:42-04:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"},{"status":"failed","code_desc":"The logged event should contain required fields. The stdout is expected to match /\"Successful login\"/","run_time":0.095318924,"start_time":"2020-09-23T21:31:43-04:00","message":"expected \"\" to match /\"Successful login\"/\nDiff:\n@@ -1 +1 @@\n-/\"Successful login\"/\n+\"\"\n"},{"status":"failed","code_desc":"Delete the jdoe user. The exit_status is expected to eq 0","run_time":0.202908265,"start_time":"2020-09-23T21:31:43-04:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"id":"V-58113","title":"Couchbase must generate audit records when concurrent\n  logons/connections by the same user from different workstations occur.","desc":"For completeness of forensic analysis, it is necessary to track who\n  logs on to Couchbase.\n\n  Concurrent connections by the same user from multiple workstations may be\n  valid use of the system; or such connections may be due to improper\n  circumvention of the requirement to use the CAC for authentication; or they may\n  indicate unauthorized account sharing; or they may be because an account has\n  been compromised.\n\n  (If the fact of multiple, concurrent logons by a given user can be reliably\n  reconstructed from the log entries for other events (logons/connections;\n  voluntary and involuntary disconnections), then it is not mandatory to create\n  additional log entries specifically for this.)","descriptions":[{"label":"default","data":"For completeness of forensic analysis, it is necessary to track who\n  logs on to Couchbase.\n\n  Concurrent connections by the same user from multiple workstations may be\n  valid use of the system; or such connections may be due to improper\n  circumvention of the requirement to use the CAC for authentication; or they may\n  indicate unauthorized account sharing; or they may be because an account has\n  been compromised.\n\n  (If the fact of multiple, concurrent logons by a given user can be reliably\n  reconstructed from the log entries for other events (logons/connections;\n  voluntary and involuntary disconnections), then it is not mandatory to create\n  additional log entries specifically for this.)"},{"label":"check","data":"Once enabled on the cluster, Couchbase auditing provides the following\nfields by default:\n  - \"id\" - ID of Event\n  - \"name\" - Name of Event (can indicate success/failure)\n  - \"description\" - Event Description (can indicate success/failure)\n  - \"filtering_permitted\" - Whether the event is filterable\n  - \"mandatory_fields\" - Includes \"timestamp\" (UTC time and ISO 8601\n    format) and \"user\" fields\n\nAs the Full Admin, create a user account by executing the following command:\n  $couchbase-cli user-manage -c <host>:<port> -u <Full Admin>     -p <Password> --set --rbac-username jdoe --rbac-password cbpass     --rbac-name \"John Doe\" --roles replication_admin     --auth-domain local\n\nVerify that the event logged contains the required fields:\n  $ cat <Couchbase Home>/var/lib/couchbase/logs/audit.log \n    \nIf the log does not contain the \"ip\", \"timestamp\", the \"username\" \n,\"sessionid\", or the \"port\" field; this is a finding."},{"label":"fix","data":"Enable session auditing on the Couchbase cluster to produce sufficient\ninformation regarding the types of events that have occurred.\n\nCouchbase Server 6.5.0 and earlier -\nAs the Full Admin, execute the following command to enable auditing:\n  $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n  --password <Password> --audit-enabled 1 --audit-log-rotate-interval 604800\n  --audit-log-path /opt/couchbase/var/lib/couchbase/logs\n\nCouchbase Server Version 6.51 and later -\nAs the Full Admin, execute the following command to enable auditing:\n  $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n  --password <Password> --set  --audit-enabled 1 --audit-log-rotate-interval\n  604800 --audit-log-path /opt/couchbase/var/lib/couchbase/logs"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000506-DB-000353","gid":"V-58113","rid":"SV-72543r1_rule","stig_id":"SRG-APP-000506-DB-000353","fix_id":"F-63321r1_fix","cci":["CCI-000172"],"nist":["AU-12 c","Rev_4"]},"code":"control \"V-58113\" do\n  title \"Couchbase must generate audit records when concurrent\n  logons/connections by the same user from different workstations occur.\"\n  desc  \"For completeness of forensic analysis, it is necessary to track who\n  logs on to Couchbase.\n\n  Concurrent connections by the same user from multiple workstations may be\n  valid use of the system; or such connections may be due to improper\n  circumvention of the requirement to use the CAC for authentication; or they may\n  indicate unauthorized account sharing; or they may be because an account has\n  been compromised.\n\n  (If the fact of multiple, concurrent logons by a given user can be reliably\n  reconstructed from the log entries for other events (logons/connections;\n  voluntary and involuntary disconnections), then it is not mandatory to create\n  additional log entries specifically for this.)\n  \"\n  desc  \"check\", \"\n  Once enabled on the cluster, Couchbase auditing provides the following\n  fields by default:\n    - \\\"id\\\" - ID of Event\n    - \\\"name\\\" - Name of Event (can indicate success/failure)\n    - \\\"description\\\" - Event Description (can indicate success/failure)\n    - \\\"filtering_permitted\\\" - Whether the event is filterable\n    - \\\"mandatory_fields\\\" - Includes \\\"timestamp\\\" (UTC time and ISO 8601\n      format) and \\\"user\\\" fields\n\n  As the Full Admin, create a user account by executing the following command:\n    $couchbase-cli user-manage -c <host>:<port> -u <Full Admin> \\\n    -p <Password> --set --rbac-username jdoe --rbac-password cbpass \\\n    --rbac-name \\\"John Doe\\\" --roles replication_admin \\\n    --auth-domain local\n  \n  Verify that the event logged contains the required fields:\n    $ cat <Couchbase Home>/var/lib/couchbase/logs/audit.log \n      \n  If the log does not contain the \\\"ip\\\", \\\"timestamp\\\", the \\\"username\\\" \n  ,\\\"sessionid\\\", or the \\\"port\\\" field; this is a finding.\n  \"\n  desc  \"fix\", \"\n  Enable session auditing on the Couchbase cluster to produce sufficient\n  information regarding the types of events that have occurred.\n\n  Couchbase Server 6.5.0 and earlier -\n  As the Full Admin, execute the following command to enable auditing:\n    $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n    --password <Password> --audit-enabled 1 --audit-log-rotate-interval 604800\n    --audit-log-path /opt/couchbase/var/lib/couchbase/logs\n\n  Couchbase Server Version 6.51 and later -\n  As the Full Admin, execute the following command to enable auditing:\n    $ couchbase-cli setting-audit --cluster <host>:<port> --u <Full Admin>\n    --password <Password> --set  --audit-enabled 1 --audit-log-rotate-interval\n    604800 --audit-log-path /opt/couchbase/var/lib/couchbase/logs\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000506-DB-000353\"\n  tag \"gid\": \"V-58113\"\n  tag \"rid\": \"SV-72543r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000506-DB-000353\"\n  tag \"fix_id\": \"F-63321r1_fix\"\n  tag \"cci\": [\"CCI-000172\"]\n  tag \"nist\": [\"AU-12 c\", \"Rev_4\"]\n\n  describe \"Create the jdoe user. The\" do \n    subject { command(\"#{input('cb_bin_dir')}/couchbase-cli user-manage \\\n    -c #{input('cb_cluster_host')}:#{input('cb_cluster_port')} \\\n    -u #{input('cb_full_admin')} -p #{input('cb_full_admin_password')} \\\n    --set --rbac-username jdoe --rbac-password cbpass --rbac-name 'John Doe' \\\n    --roles replication_admin --auth-domain local\") }\n    its('exit_status') { should eq 0 }\n  end\n\n  describe \"The logged event should contain required fields. The\" do\n    subject { command(\"grep 'jdoe' #{input('cb_audit_log')} | tail -1\") }\n    its('stdout') { should match /\"timestamp\"/}\n    its('stdout') { should match /\"ip\"/}\n    its('stdout') { should match /\"port\"/}\n    its('stdout') { should match /\"sessionid\"/}\n    its('stdout') { should match /\"username\"/}\n  end\n\n  describe \"Delete the jdoe user. The\" do \n    subject { command(\"#{input('cb_bin_dir')}/couchbase-cli user-manage \\\n    -c #{input('cb_cluster_host')}:#{input('cb_cluster_port')} \\\n    -u #{input('cb_full_admin')} -p #{input('cb_full_admin_password')} \\\n    --delete --rbac-username jdoe --auth-domain local\") }\n    its('exit_status') { should eq 0 }\n  end \nend\n","source_location":{"line":3,"ref":"/home/ubuntu/Desktop/couchbase-enterprise-srg-baseline/controls/V-58113.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Create the jdoe user. The exit_status is expected to eq 0","run_time":0.226433216,"start_time":"2020-09-23T21:31:43-04:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"},{"status":"failed","code_desc":"The logged event should contain required fields. The stdout is expected to match /\"timestamp\"/","run_time":0.080305955,"start_time":"2020-09-23T21:31:43-04:00","message":"expected \"\" to match /\"timestamp\"/\nDiff:\n@@ -1 +1 @@\n-/\"timestamp\"/\n+\"\"\n"},{"status":"failed","code_desc":"The logged event should contain required fields. The stdout is expected to match /\"ip\"/","run_time":0.091840977,"start_time":"2020-09-23T21:31:43-04:00","message":"expected \"\" to match /\"ip\"/\nDiff:\n@@ -1 +1 @@\n-/\"ip\"/\n+\"\"\n"},{"status":"failed","code_desc":"The logged event should contain required fields. The stdout is expected to match /\"port\"/","run_time":0.083614324,"start_time":"2020-09-23T21:31:43-04:00","message":"expected \"\" to match /\"port\"/\nDiff:\n@@ -1 +1 @@\n-/\"port\"/\n+\"\"\n"},{"status":"failed","code_desc":"The logged event should contain required fields. The stdout is expected to match /\"sessionid\"/","run_time":0.07526543,"start_time":"2020-09-23T21:31:43-04:00","message":"expected \"\" to match /\"sessionid\"/\nDiff:\n@@ -1 +1 @@\n-/\"sessionid\"/\n+\"\"\n"},{"status":"failed","code_desc":"The logged event should contain required fields. The stdout is expected to match /\"username\"/","run_time":0.118007818,"start_time":"2020-09-23T21:31:43-04:00","message":"expected \"\" to match /\"username\"/\nDiff:\n@@ -1 +1 @@\n-/\"username\"/\n+\"\"\n"},{"status":"failed","code_desc":"Delete the jdoe user. The exit_status is expected to eq 0","run_time":0.255811401,"start_time":"2020-09-23T21:31:44-04:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]}],"status":"loaded","status_message":""}],"statistics":{"duration":4.040958238},"version":"4.23.4"}